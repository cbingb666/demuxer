{"version":3,"file":"demuxer.ts.umd.js","sources":["../src/enum/events.ts","../src/util/event-emitter.ts","../src/types/globals.ts","../src/util/is.ts","../src/util/cache-buffer.ts","../src/util/multi-map.ts","../src/util/event-manager.ts","../src/util/global.ts","../src/util/logger.ts","../src/util/stream.ts","../src/demux-facade.ts","../src/mux-error-code.ts","../src/util/dv.ts","../src/m2t/structs/patSection.ts","../src/m2t/structs/pmtSection.ts","../src/m2t/structs/sdtSection.ts","../src/enum/m2t-pid.ts","../src/m2t/psi.ts","../src/m2t/streams/complex.js","../src/util/platform.ts","../src/codec/aac/aac-config.ts","../src/codec/aac/aac.ts","../src/codec/adts.ts","../src/m2t/streams/adts.ts","../src/codec/avc/ep3b.ts","../src/util/exp-golumb.ts","../src/codec/avc/sps.ts","../src/codec/avc/pps.ts","../src/codec/avc/sei.ts","../src/codec/avc/nalu.ts","../src/codec/avc.ts","../src/codec/avc/avc-config.ts","../src/m2t/streams/avc.ts","../src/m2t/streams/elementary.ts","../src/m2t/structs/pes.ts","../src/m2t/streams/pes.ts","../src/m2t/structs/packet.ts","../src/m2t/demux.ts"],"sourcesContent":["/**\n * @file= events.js, created at Monday, 23rd December 2019 3=47=23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nexport enum Events {\n\tERROR = 'ERROR',\n\tINFO = 'INFO',\n\tDATA = 'DATA',\n\tDEMUX_DATA = 'DEMUX_DATA',\n\tDONE = 'DONE'\n}\n","/**\n * @copyright https://github.com/nodejs/node/blob/master/lib/events.js\n */\n/* eslint-disable */\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar objectCreate = Object.create || objectCreatePolyfill;\nvar objectKeys = Object.keys || objectKeysPolyfill;\nvar bind = Function.prototype.bind || functionBindPolyfill;\n\n// By default Dispatchers will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nlet defaultMaxListeners = 10;\n\nexport default class EventEmitter {\n\tstatic listenerCount(emitter, type) {\n\t\tif (typeof emitter.listenerCount === 'function') {\n\t\t\treturn emitter.listenerCount(type);\n\t\t} else {\n\t\t\treturn listenerCount.call(emitter, type);\n\t\t}\n\t}\n\n\tstatic defaultMaxListeners: number;\n\n\t_maxListeners?: number;\n\t_eventsCount: number;\n\t_events: any;\n\n\tconstructor() {\n\t\tif (!this._events || !Object.prototype.hasOwnProperty.call(this, '_events')) {\n\t\t\tthis._events = objectCreate(null);\n\t\t\tthis._eventsCount = 0;\n\t\t}\n\n\t\tthis._maxListeners = this._maxListeners || undefined;\n\t}\n\n\t// // Obviously not all Emitters should be limited to 10. This function allows\n\t// // that to be increased. Set to zero for unlimited.\n\t// setMaxListeners(n) {\n\t//     if (typeof n !== 'number' || n < 0 || isNaN(n))\n\t//         throw new TypeError('\"n\" argument must be a positive number');\n\t//     this._maxListeners = n;\n\t//     return this;\n\t// }\n\t//\n\t// getMaxListeners() {\n\t//     return $getMaxListeners(this);\n\t// }\n\n\temit(type: string, ...rest) {\n\t\tvar er, handler, len, args, i, events;\n\t\tvar doError = type === 'error';\n\n\t\tevents = this._events;\n\t\tif (events) doError = doError && events.error == null;\n\t\telse if (!doError) return false;\n\n\t\t// If there is no 'error' event listener then throw.\n\t\tif (doError) {\n\t\t\tif (arguments.length > 1) er = arguments[1];\n\t\t\tif (er instanceof Error) {\n\t\t\t\tthrow er; // Unhandled 'error' event\n\t\t\t} else {\n\t\t\t\t// At least give some kind of context to the user\n\t\t\t\tvar err = new Error('Unhandled \"error\" event. (' + er + ')');\n\t\t\t\terr['context'] = er;\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t}\n\n\t\thandler = events[type];\n\n\t\tif (!handler) return false;\n\n\t\tvar isFn = typeof handler === 'function';\n\t\tlen = arguments.length;\n\t\tswitch (len) {\n\t\t\t// fast cases\n\t\t\tcase 1:\n\t\t\t\temitNone(handler, isFn, this);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\temitOne(handler, isFn, this, arguments[1]);\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\temitTwo(handler, isFn, this, arguments[1], arguments[2]);\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\temitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);\n\t\t\t\tbreak;\n\t\t\t// slower\n\t\t\tdefault:\n\t\t\t\targs = new Array(len - 1);\n\t\t\t\tfor (i = 1; i < len; i++) args[i - 1] = arguments[i];\n\t\t\t\temitMany(handler, isFn, this, args);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\ton(type: string, listener: Function) {\n\t\treturn _addListener(this, type, listener);\n\t}\n\n\tonce(type, listener) {\n\t\tif (typeof listener !== 'function') throw new TypeError('\"listener\" argument must be a function');\n\t\tthis.on(type, _onceWrap(this, type, listener));\n\t\treturn this;\n\t}\n\n\toff(type, listener) {\n\t\treturn _removeListener.call(this, type, listener);\n\t}\n\n\tremoveAllListeners(type) {\n\t\tvar listeners, events, i;\n\n\t\tevents = this._events;\n\t\tif (!events) return this;\n\n\t\t// not listening for off, no need to emit\n\t\tif (!events.off) {\n\t\t\tif (arguments.length === 0) {\n\t\t\t\tthis._events = objectCreate(null);\n\t\t\t\tthis._eventsCount = 0;\n\t\t\t} else if (events[type]) {\n\t\t\t\tif (--this._eventsCount === 0) this._events = objectCreate(null);\n\t\t\t\telse delete events[type];\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\t// emit off for all listeners on all events\n\t\tif (arguments.length === 0) {\n\t\t\tvar keys = objectKeys(events);\n\t\t\tvar key;\n\t\t\tfor (i = 0; i < keys.length; ++i) {\n\t\t\t\tkey = keys[i];\n\t\t\t\tif (key === 'off') continue;\n\t\t\t\tthis.removeAllListeners(key);\n\t\t\t}\n\t\t\tthis.removeAllListeners('off');\n\t\t\tthis._events = objectCreate(null);\n\t\t\tthis._eventsCount = 0;\n\t\t\treturn this;\n\t\t}\n\n\t\tlisteners = events[type];\n\n\t\tif (typeof listeners === 'function') {\n\t\t\tthis.off(type, listeners);\n\t\t} else if (listeners) {\n\t\t\t// LIFO order\n\t\t\tfor (i = listeners.length - 1; i >= 0; i--) {\n\t\t\t\tthis.off(type, listeners[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tlisteners(type) {\n\t\treturn _listeners(this, type, true);\n\t}\n\n\trawListeners(type) {\n\t\treturn _listeners(this, type, false);\n\t}\n\n\tlistenerCount() {\n\t\treturn EventEmitter.listenerCount.apply(this, arguments);\n\t}\n}\n\nlet hasDefineProperty;\ntry {\n\tvar o = {};\n\tif (Object.defineProperty) Object.defineProperty(o, 'x', { value: 0 });\n\thasDefineProperty = o['x'] === 0;\n} catch (err) {\n\thasDefineProperty = false;\n}\nif (hasDefineProperty) {\n\tObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n\t\tenumerable: true,\n\t\tget: function () {\n\t\t\treturn defaultMaxListeners;\n\t\t},\n\t\tset: function (arg) {\n\t\t\t// check whether the input is a positive number (whose value is zero or\n\t\t\t// greater and not a NaN).\n\t\t\tif (typeof arg !== 'number' || arg < 0 || arg !== arg)\n\t\t\t\tthrow new TypeError('\"defaultMaxListeners\" must be a positive number');\n\t\t\tdefaultMaxListeners = arg;\n\t\t}\n\t});\n} else {\n\tEventEmitter.defaultMaxListeners = defaultMaxListeners;\n}\n\nfunction $getMaxListeners(that) {\n\tif (that._maxListeners === undefined) return EventEmitter.defaultMaxListeners;\n\treturn that._maxListeners;\n}\n\n// These standalone emit* functions are used to optimize calling of event\n// handlers for fast cases because emit() itself often has a variable number of\n// arguments and can be deoptimized because of that. These functions always have\n// the same number of arguments and thus do not get deoptimized, so the code\n// inside them can execute faster.\nfunction emitNone(handler, isFn, self) {\n\tif (isFn) handler.call(self);\n\telse {\n\t\tvar len = handler.length;\n\t\tvar listeners = arrayClone(handler, len);\n\t\tfor (var i = 0; i < len; ++i) {\n\t\t\ttry {\n\t\t\t\tlisteners[i].call(self);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction emitOne(handler, isFn, self, arg1) {\n\tif (isFn) handler.call(self, arg1);\n\telse {\n\t\tvar len = handler.length;\n\t\tvar listeners = arrayClone(handler, len);\n\t\tfor (var i = 0; i < len; ++i) {\n\t\t\ttry {\n\t\t\t\tlisteners[i].call(self, arg1);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction emitTwo(handler, isFn, self, arg1, arg2) {\n\tif (isFn) handler.call(self, arg1, arg2);\n\telse {\n\t\tvar len = handler.length;\n\t\tvar listeners = arrayClone(handler, len);\n\t\tfor (var i = 0; i < len; ++i) {\n\t\t\ttry {\n\t\t\t\tlisteners[i].call(self, arg1, arg2);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction emitThree(handler, isFn, self, arg1, arg2, arg3) {\n\tif (isFn) handler.call(self, arg1, arg2, arg3);\n\telse {\n\t\tvar len = handler.length;\n\t\tvar listeners = arrayClone(handler, len);\n\t\tfor (var i = 0; i < len; ++i) {\n\t\t\ttry {\n\t\t\t\tlisteners[i].call(self, arg1, arg2, arg3);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction emitMany(handler, isFn, self, args) {\n\tif (isFn) handler.apply(self, args);\n\telse {\n\t\tvar len = handler.length;\n\t\tvar listeners = arrayClone(handler, len);\n\t\tfor (var i = 0; i < len; ++i) {\n\t\t\ttry {\n\t\t\t\tlisteners[i].apply(self, args);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction _addListener(target: EventEmitter, type, listener: Function) {\n\tvar m;\n\tvar events;\n\tvar existing;\n\n\tif (typeof listener !== 'function') throw new TypeError('\"listener\" argument must be a function');\n\n\tevents = target._events;\n\tif (!events) {\n\t\tevents = target._events = objectCreate(null);\n\t\ttarget._eventsCount = 0;\n\t} else {\n\t\t// To avoid recursion in the case that type === \"newListener\"! Before\n\t\t// adding it to the listeners, first emit \"newListener\".\n\t\tif (events.newListener) {\n\t\t\ttarget.emit('newListener', type, listener['listener'] ? listener['listener'] : listener);\n\n\t\t\t// Re-assign `events` because a newListener handler could have caused the\n\t\t\t// this._events to be assigned to a new object\n\t\t\tevents = target._events;\n\t\t}\n\t\texisting = events[type];\n\t}\n\n\tif (!existing) {\n\t\t// Optimize the case of one listener. Don't need the extra array object.\n\t\texisting = events[type] = listener;\n\t\t++target._eventsCount;\n\t} else {\n\t\tif (typeof existing === 'function') {\n\t\t\t// Adding the second element, need to change to array.\n\t\t\texisting = events[type] = [existing, listener];\n\t\t} else {\n\t\t\texisting.push(listener);\n\t\t}\n\n\t\t// Check for listener leak\n\t\tif (!existing.warned) {\n\t\t\tm = $getMaxListeners(target);\n\t\t\tif (m && m > 0 && existing.length > m) {\n\t\t\t\texisting.warned = true;\n\n\t\t\t\tclass CustomError extends Error {\n\t\t\t\t\temitter: any;\n\t\t\t\t\ttype: string;\n\t\t\t\t\tcount: number;\n\t\t\t\t}\n\t\t\t\tlet w: CustomError = new CustomError(\n\t\t\t\t\t'Possible Dispatcher memory leak detected. ' +\n\t\t\t\t\t\texisting.length +\n\t\t\t\t\t\t' \"' +\n\t\t\t\t\t\tString(type) +\n\t\t\t\t\t\t'\" listeners ' +\n\t\t\t\t\t\t'added. Use emitter.setMaxListeners() to ' +\n\t\t\t\t\t\t'increase limit.'\n\t\t\t\t);\n\t\t\t\tw.name = 'MaxListenersExceededWarning';\n\t\t\t\tw.emitter = target;\n\t\t\t\tw.type = type;\n\t\t\t\tw.count = existing.length;\n\n\t\t\t\tif (typeof console === 'object' && console.warn) {\n\t\t\t\t\tconsole.warn('%s: %s', w.name, w.message);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn target;\n}\n\nfunction _removeListener(type, listener) {\n\tvar list, events, position, i, originalListener;\n\n\tif (typeof listener !== 'function') throw new TypeError('\"listener\" argument must be a function');\n\n\tevents = this._events;\n\tif (!events) return this;\n\n\tlist = events[type];\n\tif (!list) return this;\n\n\tif (list === listener || list.listener === listener) {\n\t\tif (--this._eventsCount === 0) this._events = objectCreate(null);\n\t\telse {\n\t\t\tdelete events[type];\n\t\t\tif (events.off) this.emit('off', type, list.listener || listener);\n\t\t}\n\t} else if (typeof list !== 'function') {\n\t\tposition = -1;\n\n\t\tfor (i = list.length - 1; i >= 0; i--) {\n\t\t\tif (list[i] === listener || list[i].listener === listener) {\n\t\t\t\toriginalListener = list[i].listener;\n\t\t\t\tposition = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (position < 0) return this;\n\n\t\tif (position === 0) list.shift();\n\t\telse spliceOne(list, position);\n\n\t\tif (list.length === 1) events[type] = list[0];\n\n\t\tif (events.off) this.emit('off', type, originalListener || listener);\n\t}\n\n\treturn this;\n}\n\nfunction onceWrapper() {\n\tif (!this.fired) {\n\t\tthis.target.off(this.type, this.wrapFn);\n\t\tthis.fired = true;\n\t\tswitch (arguments.length) {\n\t\t\tcase 0:\n\t\t\t\treturn this.listener.call(this.target);\n\t\t\tcase 1:\n\t\t\t\treturn this.listener.call(this.target, arguments[0]);\n\t\t\tcase 2:\n\t\t\t\treturn this.listener.call(this.target, arguments[0], arguments[1]);\n\t\t\tcase 3:\n\t\t\t\treturn this.listener.call(this.target, arguments[0], arguments[1], arguments[2]);\n\t\t\tdefault:\n\t\t\t\tvar args = new Array(arguments.length);\n\t\t\t\tfor (var i = 0; i < args.length; ++i) args[i] = arguments[i];\n\t\t\t\tthis.listener.apply(this.target, args);\n\t\t}\n\t}\n}\n\nfunction _onceWrap(target, type, listener) {\n\tvar state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n\tvar wrapped = bind.call(onceWrapper, state);\n\twrapped.listener = listener;\n\tstate.wrapFn = wrapped;\n\treturn wrapped;\n}\n\nfunction _listeners(target, type, unwrap) {\n\tvar events = target._events;\n\n\tif (!events) return [];\n\n\tvar evlistener = events[type];\n\tif (!evlistener) return [];\n\n\tif (typeof evlistener === 'function') return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n\treturn unwrap ? unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nfunction listenerCount(type) {\n\tvar events = this._events;\n\n\tif (events) {\n\t\tvar evlistener = events[type];\n\n\t\tif (typeof evlistener === 'function') {\n\t\t\treturn 1;\n\t\t} else if (evlistener) {\n\t\t\treturn evlistener.length;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\n// About 1.5x faster than the two-arg version of Array#splice().\nfunction spliceOne(list, index) {\n\tfor (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1) list[i] = list[k];\n\tlist.pop();\n}\n\nfunction arrayClone(arr, n) {\n\tvar copy = new Array(n);\n\tfor (var i = 0; i < n; ++i) copy[i] = arr[i];\n\treturn copy;\n}\n\nfunction unwrapListeners(arr) {\n\tvar ret = new Array(arr.length);\n\tfor (var i = 0; i < ret.length; ++i) {\n\t\tret[i] = arr[i].listener || arr[i];\n\t}\n\treturn ret;\n}\n\nfunction objectCreatePolyfill(proto) {\n\tvar F = function () {};\n\tF.prototype = proto;\n\treturn new F();\n}\n\nfunction objectKeysPolyfill(obj) {\n\tvar keys = [];\n\tfor (var k in obj)\n\t\tif (Object.prototype.hasOwnProperty.call(obj, k)) {\n\t\t\tkeys.push(k);\n\t\t}\n\treturn k;\n}\n\nfunction functionBindPolyfill(context) {\n\tvar fn = this;\n\treturn function () {\n\t\treturn fn.apply(context, arguments);\n\t};\n}\n","import EventEmitter from '../util/event-emitter';\n\nexport class Context extends EventEmitter {}\n\nexport type PushConf = Partial<{\n\tdone: boolean;\n\tstubTime: number;\n\toffsetPos: number; // Represents the start byte of the pushed data relative to the entire file\n}>;\n\nexport type GlobalOptions = Partial<{\n\tdebug: boolean;\n\tdecodeCodec: boolean;\n\tconfig: PushConf;\n}>;\n\nexport interface IDemux {\n\t/**\n\t * Pipe the arrayBuffer to the demuxer.\n\t * @param buf\n\t * @param conf\n\t */\n\tpush(buf: ArrayBuffer | Uint8Array, conf: PushConf): void;\n\n\treset(): void;\n\n\tdestroy(): void;\n}\n","/**\n * @file: is.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = Object.prototype.toString;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nexport function isObjectLike(value: any): boolean {\n\treturn !!value && typeof value == 'object';\n}\n\nexport function isEmptyObject(obj: object): boolean {\n\tfor (var prop in obj) {\n\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn JSON.stringify(obj) === JSON.stringify({});\n}\n\n/**\n * @param url\n */\nexport function isHttps(url?: string): boolean {\n\treturn /^https/gi.test(url || window.location.protocol);\n}\n\n/**\n * @param num\n */\nexport function isNumber(num: any): boolean {\n\treturn typeof num === 'number' && !isNaN(num);\n}\n\n/**\n * @param value\n */\nexport function isArrayBuffer(value: any): boolean {\n\treturn isObjectLike(value) && objectToString.call(value).toLowerCase() === '[object arraybuffer]';\n}\n\n/**\n * @param value\n */\nexport function isUint8Array(value: any): boolean {\n\treturn isObjectLike(value) && objectToString.call(value).toLowerCase() === '[object uint8array]';\n}\n","/**\n * @file: cache-buffer.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport { isNumber } from './is';\n\n/**\n * Cache Buffer util.\n * It's applicable for streaming data cutting and retaining the data,\n * the algorithm minimizes memory application as much as possible.\n */\n\nexport default class CacheBuffer {\n\tget byteLength(): number {\n\t\tif (!isNumber(this.byteLength_)) {\n\t\t\tlet len = 0;\n\n\t\t\tfor (let i = 0, item: Uint8Array; i < this.list_.length; i++) {\n\t\t\t\titem = this.list_[i];\n\t\t\t\tlen += item.byteLength;\n\t\t\t}\n\t\t\tthis.byteLength_ = len;\n\t\t}\n\n\t\treturn this.byteLength_;\n\t}\n\n\t/**\n\t * maybe return new allocated memory or original memory\n\t */\n\tget bytes(): Uint8Array | null {\n\t\tconst { bufferList } = this;\n\t\tlet bytes = null;\n\n\t\tif (bufferList.length > 0) {\n\t\t\tif (bufferList.length === 0) {\n\t\t\t\tbytes = bufferList[0];\n\t\t\t} else {\n\t\t\t\tbytes = this.toNewBytes();\n\t\t\t}\n\t\t}\n\n\t\treturn bytes;\n\t}\n\n\tget empty() {\n\t\treturn this.list_.length === 0;\n\t}\n\n\tget bufferList() {\n\t\treturn this.list_;\n\t}\n\n\t/**\n\t * Used to cache calculations, reduce the number of CPU calculations.\n\t * When internal data changes, the value needs to be cleared and recalculated.\n\t */\n\tprivate byteLength_: number | null;\n\n\tprivate list_: Array<Uint8Array> = [];\n\n\tclear() {\n\t\tlet len = this.list_.length;\n\t\tif (len > 0) {\n\t\t\tthis.list_.splice(0, len);\n\t\t}\n\t\tthis.byteLength_ = null;\n\t}\n\n\ttoNewBytes(): Uint8Array | null {\n\t\tlet bytes = null;\n\t\tlet tryCount: number = 0;\n\t\tlet maxTryCount: number = 50;\n\n\t\t// The following retry strategies are provided for failed memory applications\n\t\t// In terms of a better strategy, a failed memory application retry should be\n\t\t// an asynchronous process, which does not return until the application succeeds.\n\t\t// But the original design of the library is synchronous.\n\t\twhile (bytes === null) {\n\t\t\ttry {\n\t\t\t\ttryCount++;\n\t\t\t\tbytes = new Uint8Array(this.byteLength);\n\t\t\t} catch (e) {\n\t\t\t\tif (tryCount > maxTryCount) {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0, offset = 0; i < this.list_.length; i++) {\n\t\t\tlet payload = this.list_[i];\n\n\t\t\tbytes.set(payload, offset);\n\t\t\toffset += payload.byteLength;\n\t\t}\n\n\t\treturn bytes;\n\t}\n\n\tappend(newBuffer: Uint8Array | CacheBuffer): void {\n\t\tif (newBuffer instanceof CacheBuffer) {\n\t\t\tthis.list_ = this.list_.concat(newBuffer.bufferList);\n\t\t} else {\n\t\t\tthis.list_.push(newBuffer);\n\t\t}\n\n\t\tthis.byteLength_ = null;\n\t}\n\n\t/**\n\t * This function cuts a complete TypedArray from CacheBuffer and retains the remainder of CacheBuffer.\n\t * The following points should be noted when using this function:\n\t * 1. If the cut needs to return the cut-out part, the cut length should be as small as possible to reduce the errors in memory application.\n\t * 2. If the cutting is only to preserve the remaining parts, the cutting size is within the total number of bytes, without considering memory applications.\n\t * @param {number} fixedLength\n\t * @param {boolean} [needCutResult] - If not, just retain the remaining parts after cutting.\n\t */\n\tcut(fixedLength: number, needCutResult: boolean = true): Uint8Array {\n\t\tlet chunk = null;\n\n\t\tif (fixedLength > 0 && !this.empty) {\n\t\t\tlet list = this.list_;\n\n\t\t\tlet offset = 0;\n\t\t\tlet loopIndex = 0;\n\n\t\t\twhile (list.length > 0) {\n\t\t\t\tlet cur = list.shift();\n\n\t\t\t\tif (loopIndex === 0) {\n\t\t\t\t\tif (cur.byteLength >= fixedLength) {\n\t\t\t\t\t\tif (needCutResult) {\n\t\t\t\t\t\t\t// Here is the key point for optimize memory alloc\n\t\t\t\t\t\t\tchunk = cur.subarray(0, fixedLength);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (cur.byteLength > fixedLength) {\n\t\t\t\t\t\t\tcur = cur.subarray(fixedLength);\n\t\t\t\t\t\t\tlist.unshift(cur);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (needCutResult) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tchunk = new Uint8Array(fixedLength);\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tthrow `alloc_memory_error@ cache buffer: ${fixedLength} ${e.message}`;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tchunk.set(cur, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\toffset += cur.byteLength;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlet subLen = fixedLength - offset;\n\n\t\t\t\t\tif (cur.byteLength >= subLen) {\n\t\t\t\t\t\tif (needCutResult) {\n\t\t\t\t\t\t\tchunk.set(cur.subarray(0, subLen), offset);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcur = cur.subarray(subLen);\n\n\t\t\t\t\t\tif (cur.byteLength > 0) {\n\t\t\t\t\t\t\tlist.unshift(cur);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (needCutResult) {\n\t\t\t\t\t\t\tchunk.set(cur, offset);\n\t\t\t\t\t\t}\n\t\t\t\t\t\toffset += cur.byteLength;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tloopIndex++;\n\t\t\t}\n\n\t\t\tthis.byteLength_ = null;\n\t\t}\n\n\t\treturn chunk;\n\t}\n}\n","/**\n * @fileOverview A simple multimap template.\n */\n\ninterface MapData {\n\t[index: string]: Array<any>;\n}\n\nexport default class MultiMap {\n\tprivate map_: MapData;\n\n\tconstructor() {\n\t\tthis.map_ = {};\n\t}\n\n\t/**\n\t * Add a key, value pair to the map.\n\t * @param key\n\t * @param value\n\t */\n\tpush(key: string, value: any) {\n\t\tif (this.map_.hasOwnProperty(key)) {\n\t\t\tthis.map_[key].push(value);\n\t\t} else {\n\t\t\tthis.map_[key] = [value];\n\t\t}\n\t}\n\n\t/**\n\t * Get a list of values by key.\n\t * @param key\n\t */\n\tget(key: string): Array<any> {\n\t\tlet list = this.map_[key];\n\t\t// slice() clones the list so that it and the map can each be modified\n\t\t// without affecting the other.\n\t\treturn list ? list.slice() : null;\n\t}\n\n\t/**\n\t * Get a list of all values.\n\t */\n\tgetAll(): Array<any> {\n\t\tlet list = [];\n\t\tfor (let key in this.map_) {\n\t\t\tlist.push.apply(list, this.map_[key]);\n\t\t}\n\t\treturn list;\n\t}\n\n\t/**\n\t * Remove a specific value, if it exists.\n\t * @param key\n\t * @param value\n\t */\n\tremove(key: string, value: any): void {\n\t\tlet list = this.map_[key];\n\t\tif (list) {\n\t\t\tfor (let i = 0; i < list.length; ++i) {\n\t\t\t\tif (list[i] == value) {\n\t\t\t\t\tlist.splice(i, 1);\n\t\t\t\t\t--i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Clear all keys and values from the multimap.\n\t */\n\tclear(): void {\n\t\tthis.map_ = {};\n\t}\n\n\t/**\n\t * @param callback\n\t */\n\tforEach(callback: Function): void {\n\t\tfor (let key in this.map_) {\n\t\t\tcallback(key, this.map_[key]);\n\t\t}\n\t}\n}\n","import MultiMap from './multi-map';\n\n/**\n * Creates a new Binding_ and attaches the event listener to the event target.\n */\nclass Binding_ {\n\ttarget: any;\n\ttype: string;\n\tlistener: Function;\n\n\t/**\n\t * @param target - The event target.\n\t * @param type - The event type.\n\t * @param listener - The event listener.\n\t */\n\tconstructor(target: any, type: string, listener: Function) {\n\t\tthis.target = target;\n\t\tthis.type = type;\n\t\tthis.listener = listener;\n\n\t\tif (this.target.addEventListener) {\n\t\t\tthis.target.addEventListener(type, listener, false);\n\t\t} else if (this.target.on) {\n\t\t\tthis.target.on(type, listener, false);\n\t\t}\n\t}\n\n\t/**\n\t * Detaches the event listener from the event target.\n\t * This does nothing if the event listener is already detached.\n\t */\n\toff() {\n\t\tif (this.target.removeEventListener) {\n\t\t\tthis.target.removeEventListener(this.type, this.listener, false);\n\t\t} else if (this.target.off) {\n\t\t\tthis.target.off(this.type, this.listener, false);\n\t\t}\n\n\t\tthis.target = null;\n\t\tthis.listener = null;\n\t}\n}\n\n/**\n * Creates a new EventManager.\n * An EventManager maintains a collection of \"event bindings\" between event targets and event listeners.\n */\nexport default class EventManager {\n\tprivate bindingMap_: MultiMap;\n\t// static Binding_: Binding;\n\n\tconstructor() {\n\t\t/**\n\t\t * Maps an event type to an array of event bindings.\n\t\t */\n\t\tthis.bindingMap_ = new MultiMap();\n\t}\n\n\t/**\n\t * Detaches all event listeners.\n\t * @override\n\t */\n\tdestroy(): void {\n\t\tthis.removeAll();\n\t\tthis.bindingMap_ = null;\n\t}\n\n\t/**\n\t * Attaches an event listener to an event target.\n\t * @param target - The event target.\n\t * @param type  - The event type.\n\t * @param listener  - The event listener.\n\t */\n\ton(target: any, type: string, listener: Function): EventManager {\n\t\tif (!this.bindingMap_) return;\n\n\t\tlet binding = new Binding_(target, type, listener);\n\t\tthis.bindingMap_.push(type, binding);\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Attaches an event listener to an event target.\n\t * The listener will be removed when the first instance of the event is fired.\n\t * @param {EventTarget} target The event target.\n\t * @param {string} type The event type.\n\t * @param {function} listener The event listener.\n\t */\n\tonce(target: any, type: string, listener: Function) {\n\t\t// Install a shim listener that will stop listening after the first event.\n\t\tthis.on(\n\t\t\ttarget,\n\t\t\ttype,\n\t\t\tfunction (event: any) {\n\t\t\t\t// Stop listening to this event.\n\t\t\t\tthis.off(target, type);\n\t\t\t\t// Call the original listener.\n\t\t\t\tlistener(event);\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\t/**\n\t * Detaches an event listener from an event target.\n\t * @param {EventTarget} target The event target.\n\t * @param {string} type The event type.\n\t */\n\toff(target: any, type: string): void {\n\t\tif (!this.bindingMap_) return;\n\n\t\tlet list = this.bindingMap_.get(type) || [];\n\n\t\tfor (let i = 0; i < list.length; ++i) {\n\t\t\tlet binding = list[i];\n\n\t\t\tif (binding.target == target) {\n\t\t\t\tbinding.off();\n\t\t\t\tthis.bindingMap_.remove(type, binding);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Detaches all event listeners from all targets.\n\t */\n\tremoveAll(): void {\n\t\tif (!this.bindingMap_) return;\n\n\t\tlet list = this.bindingMap_.getAll();\n\n\t\tfor (let i = 0; i < list.length; ++i) {\n\t\t\tlist[i].off();\n\t\t}\n\n\t\tthis.bindingMap_.clear();\n\t}\n}\n\n// EventManager.Binding_ = Binding;\n","/**\n * @file: global.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * @description provide global scope.\n */\nlet global: any;\n\n// see https://stackoverflow.com/a/11237259/589493\nif (typeof window === 'undefined') {\n\t/* eslint-disable-next-line no-undef */\n\tglobal = self;\n} else {\n\tglobal = window;\n}\n\nexport default global;\n","/**\n * @file: logger.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * utils - logger\n */\n/* global WorkerGlobalScope */\nimport global from './global';\nimport EventEmitter from './event-emitter';\n\nlet console = global.console;\nconst isWorker =\n\ttypeof WorkerGlobalScope !== 'undefined' &&\n\tself instanceof WorkerGlobalScope &&\n\ttypeof importScripts != 'undefined';\nconst prefix = '>>>';\n\nclass Logger extends EventEmitter {\n\tprivate MSG_NAME: string;\n\tprivate _enable: boolean;\n\n\tget enable() {\n\t\treturn this._enable;\n\t}\n\n\tset enable(value: boolean) {\n\t\tthis._enable = value;\n\n\t\tthis.MSG_NAME = '__log__';\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._enable = false;\n\t}\n\n\tlog(...restArgs: any) {\n\t\tif (isWorker) {\n\t\t\tlogger.emit(this.MSG_NAME, 'log', [...arguments].join(''));\n\t\t} else {\n\t\t\tif (this._enable) {\n\t\t\t\tconsole.log.call(console, prefix, ...arguments);\n\t\t\t}\n\t\t}\n\t}\n\n\tdebug(...restArgs: any) {\n\t\tif (isWorker) {\n\t\t\tlogger.emit(this.MSG_NAME, 'debug', [...arguments].join(''));\n\t\t} else {\n\t\t\tif (this._enable && console.debug) {\n\t\t\t\tconsole.debug.call(console, prefix, ...arguments);\n\t\t\t}\n\t\t}\n\t}\n\n\tassert(...restArgs: any) {\n\t\tif (this._enable && console.assert) {\n\t\t\tlet condition = arguments[0];\n\t\t\tlet sliceArgs = Array.prototype.slice.call(arguments, 1);\n\t\t\tsliceArgs.unshift(prefix);\n\n\t\t\tconsole.assert.call(console, condition, ...sliceArgs);\n\t\t}\n\t}\n\n\twarn(...restArgs: any) {\n\t\tif (isWorker) {\n\t\t\tlogger.emit(this.MSG_NAME, 'warn', [...arguments].join(''));\n\t\t} else {\n\t\t\tif (this._enable) {\n\t\t\t\tconsole.warn.call(console, prefix, ...arguments);\n\t\t\t}\n\t\t}\n\t}\n\n\terror(...restArgs: any) {\n\t\tif (isWorker) {\n\t\t\tlogger.emit(this.MSG_NAME, 'error', [...arguments].join(''));\n\t\t} else {\n\t\t\tif (this._enable) {\n\t\t\t\tconsole.error.call(console, prefix, ...arguments);\n\t\t\t}\n\t\t}\n\t}\n}\n\nlet logger = new Logger();\n\n/**\n * @param {Object} obj - custom logger\n */\nexport function setLogger(obj) {\n\tconsole = obj;\n}\n\nexport function getLogger() {\n\treturn logger;\n}\n\nexport default logger;\n","/**\n * @file: stream.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * simple stream implementation.\n */\n\nimport { PushConf } from '../types/globals';\nimport EventEmitter from './event-emitter';\n\nclass Stream extends EventEmitter {\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t/**\n\t * connect to the next pipeline stream.\n\t * @param destination\n\t */\n\tpipe(destination: Stream): Stream {\n\t\tthis.on('reset', function () {\n\t\t\tdestination.reset();\n\t\t});\n\n\t\tthis.on('data', function (data) {\n\t\t\tdestination.push(data);\n\t\t});\n\n\t\tthis.on('done', function (flushSource) {\n\t\t\tdestination.flush(flushSource);\n\t\t});\n\n\t\treturn destination;\n\t}\n\n\t/**\n\t * detaches the next pipeline stream previously attached.\n\t */\n\tunpipe(): Stream {\n\t\tthis.removeAllListeners('reset');\n\t\tthis.removeAllListeners('data');\n\t\tthis.removeAllListeners('done');\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * push data to current pipeline.\n\t * @param data\n\t */\n\tpush(data: any, conf?: PushConf): void {\n\t\tthis.emit('data', data);\n\t}\n\n\t/**\n\t * flush current pipeline.\n\t * @param flushSource\n\t */\n\tflush(flushSource: Stream): void {\n\t\tthis.emit('done', flushSource);\n\t}\n\n\treset(): void {\n\t\tthis.emit('reset');\n\t}\n}\n\nexport default Stream;\n","/**\n * @file: demuxer.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\nimport { Events } from './enum/events';\nimport { Context, GlobalOptions, IDemux, PushConf } from './types/globals';\nimport CacheBuffer from './util/cache-buffer';\nimport EventManager from './util/event-manager';\nimport { isArrayBuffer, isUint8Array } from './util/is';\nimport logger from './util/logger';\nimport Stream from './util/stream';\n\nexport default abstract class DemuxFacade extends Stream implements IDemux {\n\treadonly endStream?: Stream;\n\tprotected eventManager_: EventManager;\n\tprotected ctx_: Context;\n\tprotected options_: GlobalOptions;\n\tprotected cache_buffer_: CacheBuffer;\n\n\tprotected listenEndStream_(): void {\n\t\tthis.eventManager_ = new EventManager();\n\n\t\tthis.eventManager_\n\t\t\t.on(this.endStream, 'data', (data) => {\n\t\t\t\tthis.emit(Events.DEMUX_DATA, data);\n\t\t\t})\n\t\t\t.on(this.endStream, 'done', (data) => {\n\t\t\t\tthis.emit(Events.DONE, data);\n\t\t\t})\n\t\t\t.on(this.ctx_, 'error', (data) => {\n\t\t\t\tthis.emit(Events.ERROR, data);\n\t\t\t});\n\t}\n\n\tconstructor(options: GlobalOptions = {}) {\n\t\tsuper();\n\n\t\tif (options.debug) {\n\t\t\tlogger.enable = true;\n\t\t}\n\n\t\tthis.ctx_ = new Context();\n\t\tthis.options_ = options;\n\t\tthis.cache_buffer_ = new CacheBuffer();\n\t}\n\n\t/**\n\t * Pipe the arrayBuffer to the demuxer.\n\t * @param buf\n\t * @param conf\n\t */\n\tabstract push(buf: ArrayBuffer | Uint8Array, conf: PushConf): void;\n\n\t/**\n\t * transfer data to Uint8Array\n\t * @param buf\n\t */\n\tprotected constraintPushData_(buf: ArrayBuffer | Uint8Array): Uint8Array | null {\n\t\tlet newBuf = null;\n\t\tif (!isArrayBuffer(buf) && !isUint8Array(buf)) {\n\t\t\treturn newBuf;\n\t\t}\n\n\t\tif (isArrayBuffer(buf)) {\n\t\t\tnewBuf = new Uint8Array(buf);\n\t\t}\n\n\t\treturn newBuf;\n\t}\n\n\treset(): void {}\n\n\tdestroy(): void {\n\t\tthis.unpipe();\n\t\tthis.endStream.unpipe();\n\n\t\tthis.eventManager_.removeAll();\n\t}\n}\n","/**\n * @file: mux-error-code.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * @readonly\n * @enum {Number}\n */\nenum codes {\n\tWORKER_EXCEPTION = 0,\n\tWORKER_MSG_EXCEPTION,\n\tTS_SYNC_BYTE,\n\tFLV_HEAD_SIGNATURE,\n\tFLV_NOT_EXPECTED_ADJACENT_DATA\n}\n\nexport default codes;\n","/**\n * @file: dv.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Bit buffer reader like DataView.\n */\n\nfunction read(buf: ArrayBuffer | Uint8Array): DataView {\n\tlet byteOffset = 0;\n\n\tif (ArrayBuffer.isView(buf)) {\n\t\tbyteOffset = buf.byteOffset;\n\t\tbuf = buf.buffer;\n\t}\n\n\treturn new DataView(buf, byteOffset);\n}\n\nclass DataViewReader {\n\tconstructor() {}\n\n\t/**\n\t * Gets an unsigned 8-bit integer (unsigned byte).\n\t * @param buffer\n\t * @param byteOffset    The offset, in byte, from the start of the view where to read the data.\n\t * @returns {number}    An unsigned 8-bit integer number.\n\t */\n\treadUint8(buffer: ArrayBuffer | Uint8Array, byteOffset: number): number {\n\t\treturn read(buffer).getUint8(byteOffset);\n\t}\n\n\t/**\n\t * Gets an unsigned 16-bit integer (unsigned long).\n\t * @param buffer\n\t * @param byteOffset     The offset, in byte, from the start of the view where to read the data.\n\t * @param littleEndian   Indicates whether the 16-bit int is stored in little- or big-endian format.\n\t * @returns {number}     An unsigned 16-bit integer number.\n\t */\n\treadUint16(buffer: ArrayBuffer | Uint8Array, byteOffset, littleEndian: boolean = false): number {\n\t\treturn read(buffer).getUint16(byteOffset, littleEndian);\n\t}\n\n\t/**\n\t * Gets an unsigned 32-bit integer (unsigned long).\n\t * @param buffer\n\t * @param byteOffset        The offset, in byte, from the start of the view where to read the data.\n\t * @param littleEndian      Indicates whether the 32-bit int is stored in little- or big-endian format.\n\t * @returns {number}        An unsigned 32-bit integer number.\n\t */\n\treadUint32(buffer: ArrayBuffer | Uint8Array, byteOffset: number, littleEndian: boolean = false): number {\n\t\treturn read(buffer).getUint32(byteOffset, littleEndian);\n\t}\n}\n\nexport default DataViewReader;\n","/**\n * @file: patSection.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Structure for pat.\n */\nimport DataViewReader from '../../util/dv';\nimport logger from '../../util/logger';\n\n/**\n * @extends DataViewReader\n */\nclass PATSection extends DataViewReader {\n\tpublic table_id: number;\n\tpublic section_syntax_indicator: number;\n\tpublic section_length: number;\n\tpublic transport_stream_id: number;\n\tpublic version_number: number;\n\tpublic current_next_indicator: number;\n\tpublic section_number: number;\n\tpublic last_section_number: number;\n\tpublic network_PID: number;\n\tpublic pmtTable: Array<M2TS.PMTTableItem>;\n\tpublic CRC_32: number;\n\n\tconstructor(buffer: Uint8Array) {\n\t\tsuper();\n\n\t\t// program_association_section 0x00\n\t\tthis.table_id = buffer[0];\n\n\t\tthis.section_syntax_indicator = buffer[1] >> 7;\n\n\t\t// this.zero = (buffer[1] >> 6) & 0x1;\n\n\t\t// this.reserved_0 = (buffer[1] >> 4) & 0x3;\n\n\t\t// the number of bytes of the section\n\t\t// starting immediately following the section_length field, and including the CRC.\n\t\tthis.section_length = ((buffer[1] & 0x0f) << 8) | buffer[2];\n\n\t\tthis.transport_stream_id = this.readUint16(buffer, 3);\n\n\t\t// this.reserved_1 = buffer[5] >> 6;\n\n\t\tthis.version_number = (buffer[5] >> 1) & 0x1f;\n\n\t\tthis.current_next_indicator = buffer[5] && 0x01;\n\n\t\t// The section_number of the first section in the Program Association Table shall be 0x00.\n\t\t// It shall be incremented by 1 with each additional section in the PAT.\n\t\tthis.section_number = buffer[6];\n\n\t\t// The number of the last section (that is, the section with the highest section_number) of the complete PAT.\n\t\tthis.last_section_number = buffer[7];\n\n\t\tthis.network_PID = 0x00;\n\t\tvar n = 0,\n\t\t\tprogram_num,\n\t\t\treserved_3;\n\t\tvar len = this.section_length - 4 - 5; // 4: crc32, 5: bytes followed by section_length\n\n\t\tthis.pmtTable = [];\n\t\t/* loop by 4 bytes, during  */\n\t\tfor (; n < len; n += 4) {\n\t\t\tprogram_num = this.readUint16(buffer, 8 + n);\n\t\t\treserved_3 = buffer[10 + n] >> 5;\n\n\t\t\tif (program_num == 0x00) {\n\t\t\t\tthis.network_PID = ((buffer[10 + n] & 0x1f) << 8) | buffer[11 + n];\n\n\t\t\t\t// 记录该TS流的网络PID\n\t\t\t\t// TS_network_Pid = this.network_PID;\n\n\t\t\t\tlogger.log('packet->network_PID %0x /n/n', this.network_PID);\n\t\t\t} else {\n\t\t\t\tthis.pmtTable.push({\n\t\t\t\t\tprogramNum: program_num,\n\t\t\t\t\tprogram_map_PID: ((buffer[10 + n] & 0x1f) << 8) | buffer[11 + n]\n\t\t\t\t});\n\n\t\t\t\t// TS_PAT_Program\n\t\t\t\t// PAT_program;\n\t\t\t\t// PAT_program.program_map_PID = (buffer[10 + n] & 0x1F) << 8 | buffer[11 + n];\n\t\t\t\t// PAT_program.program_number = program_num;\n\t\t\t\t// this.program.push_back(PAT_program);\n\t\t\t\t// TS_program.push_back(PAT_program);//向全局PAT节目数组中添加PAT节目信息\n\t\t\t}\n\t\t}\n\n\t\tvar crcLength = this.section_length + 3;\n\t\tthis.CRC_32 =\n\t\t\t((buffer[crcLength - 4] & 0x000000ff) << 24) |\n\t\t\t((buffer[crcLength - 3] & 0x000000ff) << 16) |\n\t\t\t((buffer[crcLength - 2] & 0x000000ff) << 8) |\n\t\t\t(buffer[crcLength - 1] & 0x000000ff);\n\t}\n}\n\nexport default PATSection;\n","/**\n * @file: pmtSection.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Structure for pat.\n */\nimport DataViewReader from '../../util/dv';\nimport logger from '../../util/logger';\n\n/**\n * @extends DataViewReader\n */\nclass PMTSection extends DataViewReader {\n\ttable_id: number;\n\tsection_syntax_indicator: number;\n\tsection_length: number;\n\tprogram_number: number;\n\tversion_number: number;\n\tcurrent_next_indicator: number;\n\tsection_number: number;\n\tlast_section_number: number;\n\tPCR_PID: number;\n\tprogram_info_length: number;\n\tpes_table: Array<M2TS.PESTableItem>;\n\tCRC_32: number;\n\n\tconstructor(buffer: Uint8Array) {\n\t\tsuper();\n\n\t\t// program_map_section  0x02\n\t\tthis.table_id = buffer[0];\n\n\t\tthis.section_syntax_indicator = buffer[1] >> 7;\n\n\t\t// this.zero = (buffer[1] >> 6) & 0x1;\n\n\t\t// this.reserved_0 = (buffer[1] >> 4) & 0x3;\n\n\t\t// the number of bytes of the section\n\t\t// starting immediately following the section_length field, and including the CRC.\n\t\tthis.section_length = ((buffer[1] & 0x0f) << 8) | buffer[2];\n\n\t\t// It specifies the program to which the program_map_PID is applicable.\n\t\tthis.program_number = this.readUint16(buffer, 3);\n\n\t\t// this.reserved_1 = buffer[5] >> 6;\n\n\t\tthis.version_number = (buffer[5] >> 1) & 0x1f;\n\n\t\tthis.current_next_indicator = buffer[5] && 0x01;\n\n\t\t// The section_number of the first section in the Program Association Table shall be 0x00.\n\t\t// It shall be incremented by 1 with each additional section in the PAT.\n\t\tthis.section_number = buffer[6];\n\n\t\t// The number of the last section (that is, the section with the highest section_number) of the complete PAT.\n\t\tthis.last_section_number = buffer[7];\n\n\t\t// contain the PCR fields valid for the program specified by program_number.\n\t\tthis.PCR_PID = ((buffer[8] & 0x1f) << 8) | buffer[9];\n\n\t\t// this.reserved_2 = buffer[10] >> 4;\n\n\t\t// The number of bytes of the descriptors immediately following the program_info_length field.\n\t\tthis.program_info_length = ((buffer[10] & 0x0f) << 8) | buffer[11];\n\n\t\tif (this.program_info_length < 0) {\n\t\t\treturn;\n\t\t} else if (this.program_info_length > 2) {\n\t\t\tlet i = 0;\n\n\t\t\twhile (i < this.program_info_length) {\n\t\t\t\t// let descriptor_tag = buffer[12 + i];\n\t\t\t\tlet descriptor_length = buffer[13 + i];\n\n\t\t\t\t// \tlogger.log('descriptor_tag', descriptor_tag, descriptor_length);\n\t\t\t\ti += descriptor_length;\n\t\t\t}\n\t\t}\n\n\t\tvar es_section_pos = 12 + this.program_info_length;\n\t\tvar es_section_len = this.section_length - this.program_info_length - 9 - 4; // 9: bytes followed by section_length, 4: crc32\n\t\tvar es_section_end = es_section_pos + es_section_len;\n\n\t\tif (es_section_pos >= es_section_end) {\n\t\t\tlogger.warn(`es_section_pos < es_section_end ${es_section_pos}, ${es_section_end}`);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.pes_table = [];\n\n\t\tlet j = 0;\n\t\twhile (j < es_section_len) {\n\t\t\tlet stream_type = buffer[es_section_pos + j];\n\t\t\tlet elementary_PID = this.readUint16(buffer, es_section_pos + j + 1) & 0x1fff;\n\t\t\tlet ES_info_length = this.readUint16(buffer, es_section_pos + j + 3) & 0x0fff;\n\n\t\t\tthis.pes_table.push({\n\t\t\t\tstreamType: stream_type,\n\t\t\t\tPID: elementary_PID\n\t\t\t});\n\n\t\t\tif (ES_info_length > 2) {\n\t\t\t\tlet k = 0;\n\t\t\t\tlet es_pos = es_section_pos + j + 5;\n\n\t\t\t\twhile (k < ES_info_length) {\n\t\t\t\t\t// let descriptor_tag = buffer[es_pos + k];\n\t\t\t\t\tlet descriptor_length = buffer[es_pos + k];\n\n\t\t\t\t\t// if (descriptor_tag === )\n\t\t\t\t\tk += descriptor_length;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tj += ES_info_length + 5;\n\t\t}\n\n\t\tvar crcLength = this.section_length + 3;\n\t\tthis.CRC_32 =\n\t\t\t((buffer[crcLength - 4] & 0x000000ff) << 24) |\n\t\t\t((buffer[crcLength - 3] & 0x000000ff) << 16) |\n\t\t\t((buffer[crcLength - 2] & 0x000000ff) << 8) |\n\t\t\t(buffer[crcLength - 1] & 0x000000ff);\n\t}\n\n\tparse() {\n\t\t// let data = this.uint8;\n\t}\n}\n\nexport default PMTSection;\n","/**\n * @file: sdtSection.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Structure for sdt.\n */\nimport DataViewReader from '../../util/dv';\nimport logger from '../../util/logger';\n\nclass SDTSection extends DataViewReader {\n\ttable_id: number;\n\tsection_syntax_indicator: number;\n\tsection_length: number;\n\ttransport_stream_id: number;\n\tversion_number: number;\n\tcurrent_next_indicator: number;\n\tsection_number: number;\n\tlast_section_number: number;\n\toriginal_network_id: number;\n\tservice_table: Array<M2TS.SDTServiceItem>;\n\n\tconstructor(buffer: Uint8Array) {\n\t\tsuper();\n\n\t\t// program_map_section  0x02\n\t\tthis.table_id = buffer[0];\n\n\t\tthis.section_syntax_indicator = buffer[1] >> 7;\n\n\t\t// this.reserved_0 = (buffer[1] >> 4) & 0x3;\n\n\t\t// the number of bytes of the section\n\t\t// starting immediately following the section_length field, and including the CRC.\n\t\tthis.section_length = ((buffer[1] & 0x0f) << 8) | buffer[2];\n\n\t\t// This is a 16-bit field which serves as a label for identification of the TS,\n\t\t// about which the SDT informs, from any other multiplex within the delivery system\n\t\tthis.transport_stream_id = this.readUint16(buffer, 3);\n\n\t\t// this.reserved_1 = buffer[5] >> 6;\n\n\t\tthis.version_number = (buffer[5] >> 1) & 0x1f;\n\n\t\tthis.current_next_indicator = buffer[5] & 0x01;\n\n\t\t// The section_number of the first section in the sub_table shall be \"0x00\".\n\t\t// The section_number shall be incremented by 1 with each additional section\n\t\t// with the same table_id, transport_stream_id, and original_network_id.\n\t\tthis.section_number = buffer[6];\n\n\t\t// This 8-bit field specifies the number of the last section\n\t\t// (that is, the section with the highest section_number) of the sub_table of which this section is part\n\t\tthis.last_section_number = buffer[7];\n\n\t\t// This field gives the label identifying the network_id of the originating delivery system.\n\t\tthis.original_network_id = this.readUint16(buffer, 8);\n\n\t\t// this.reserved_2 = buffer[10];\n\n\t\t// section_length - (following the section_length field length) - crc32Length\n\t\tlet sv_len = this.section_length - 8 - 4; // 8: bytes followed by section_length, 4: crc32\n\n\t\tthis.service_table = [];\n\t\tlet i = 0;\n\n\t\twhile (i < sv_len) {\n\t\t\tlet j = 0;\n\t\t\tlet service: M2TS.SDTServiceItem = {\n\t\t\t\tservice_id: this.readUint16(buffer, 11),\n\t\t\t\tEIT_schedule_flag: buffer[13] & 0x02,\n\t\t\t\tEIT_present_following_flag: buffer[13] & 0x01,\n\t\t\t\trunning_status: buffer[14] >> 5,\n\t\t\t\tfree_CA_mode: (buffer[14] >> 4) & 0x01,\n\t\t\t\tdescriptors_loop_length: ((buffer[14] & 0x0f) << 8) | buffer[15],\n\t\t\t\tprovider_name: '',\n\t\t\t\tname: ''\n\t\t\t};\n\n\t\t\twhile (j < service.descriptors_loop_length) {\n\t\t\t\tlet start = 16 + j;\n\t\t\t\tlet descriptor_tag = buffer[start];\n\t\t\t\tlet descriptor_length = buffer[start + 1];\n\n\t\t\t\tswitch (descriptor_tag) {\n\t\t\t\t\tcase 0x48: // service_descriptor\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// let service_type = buffer[start + 2];\n\t\t\t\t\t\t\tlet service_provider_name = [];\n\t\t\t\t\t\t\tlet service_provider_name_length = buffer[start + 3];\n\t\t\t\t\t\t\tlet k = 0,\n\t\t\t\t\t\t\t\tl = 0,\n\t\t\t\t\t\t\t\tnextPos = start + 4;\n\n\t\t\t\t\t\t\tfor (k = 0; k < service_provider_name_length; k++) {\n\t\t\t\t\t\t\t\tservice_provider_name.push(String.fromCharCode(buffer[nextPos]));\n\t\t\t\t\t\t\t\tnextPos += 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tservice.provider_name = service_provider_name.join('');\n\n\t\t\t\t\t\t\tlet service_name = [];\n\t\t\t\t\t\t\tlet service_name_length = buffer[nextPos];\n\t\t\t\t\t\t\tnextPos += 1;\n\n\t\t\t\t\t\t\tfor (l = 0; l < service_name_length; l++) {\n\t\t\t\t\t\t\t\tservice_name.push(String.fromCharCode(buffer[nextPos]));\n\t\t\t\t\t\t\t\tnextPos += 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tservice.name = service_name.join('');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tlogger.warn(`sdt section unhandled descriptor_tag ${descriptor_tag}`);\n\t\t\t\t}\n\n\t\t\t\tj += 2 + descriptor_length;\n\t\t\t}\n\n\t\t\tthis.service_table.push(service);\n\n\t\t\ti += 5 + service.descriptors_loop_length;\n\t\t}\n\t}\n}\n\nexport default SDTSection;\n","/**\n * @file: m2t-pid.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * @overview Program and program element descriptors.\n * @see ISO/IEC 13818-1: Table 2-3 – PID table\n * @see DVB SI: 5.1.3 Coding of PID and table_id fields\n */\n\n/**\n * @readonly\n * @enum {number}\n * @export\n */\nexport const PAT_PID = 0x0000;\nexport const CAT_PID = 0x0001;\nexport const TSDT_PID = 0x0002;\n/* reserved 0x0003 to 0x000F */\nexport const SDT_PID = 0x0011;\n","/**\n * @file: psi.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * PSI(Program Specific Information)\n */\n\nimport PATSection from './structs/patSection';\nimport PMTSection from './structs/pmtSection';\nimport SDTSection from './structs/sdtSection';\nimport { PAT_PID, CAT_PID, TSDT_PID, SDT_PID } from '../enum/m2t-pid';\nimport { Context } from '../types/globals';\nimport Packet from './structs/packet';\nimport StreamTypes from '../enum/stream-types';\n\n// const MAX_PIDS_PER_PROGRAM = 64;\n\nexport interface Track {\n\tid: number;\n\tduration: number;\n\twidth?: number;\n\theight?: number;\n\tcodec: string;\n\trealCodec?: string;\n\tprofileIdc?: number;\n\tprofileCompatibility?: number;\n\tlevelIdc?: number;\n\tpixelRatio?: [number, number];\n\ttimescale: number; // (in TS timescale = 90kHz)\n\tinputTimeScale?: number;\n\tsps: Array<Uint8Array>;\n\tpps: Array<Uint8Array>;\n\tstream_type: StreamTypes;\n\tpcr_pid: number;\n\n\t// Audio\n\tisAAC?: boolean;\n\tsampleRate?: number;\n\tchannelCount?: number;\n\tconfig?: any;\n}\n\nclass Metadata {\n\tservice_name: string;\n\tservice_provider: string;\n}\n\nclass PSI {\n\t/**\n\t * program PID\n\t */\n\tget currentProgramPID(): number {\n\t\tlet _pmtIds = [];\n\n\t\tfor (let i = 0; i < this.pat_table.length; i++) {\n\t\t\t_pmtIds.push(this.pat_table[i].pid);\n\t\t}\n\n\t\treturn _pmtIds.length > 0 ? _pmtIds[0] : -1;\n\t}\n\n\t// get pmtTable() {\n\t//     return this.pat_table;\n\t// }\n\n\tprivate context: Context;\n\tprivate metadata: Metadata; // Specify by SDT Packet\n\tprivate pat_table: Array<M2TS.PATTableItem>; // Specify by PMT Packet\n\tprivate pes_streams: Array<M2TS.PSI_PES_Stream>; // Specify by PES stream\n\n\tconstructor(ctx: Context) {\n\t\tthis.context = ctx;\n\t\tthis.metadata = new Metadata();\n\t\tthis.pat_table = [];\n\t\tthis.pes_streams = [];\n\t}\n\n\t/**\n\t * 目前对于PSI的信息，持久化保留在内存中\n\t * 对于同一个片子，HLS规范会规定只能有一个 PMT/PAT 表\n\t * 所以一部片子的PSI信息应该是保持不变的，换片子后PSI信息的销毁通过 mux 重新实例化产生新的信息，不需要调用reset\n\t * 有些 TS 文件在HLS切片器切割的时候，没有带上PAT/PMT等表，需要相邻 TS 给定的表信息\n\t */\n\treset(): void {\n\t\tthis.metadata = new Metadata();\n\t\tthis.pat_table.splice(0, this.pat_table.length);\n\t\tthis.pes_streams.splice(0, this.pes_streams.length);\n\t}\n\n\t/**\n\t * @param packet\n\t */\n\tparse(packet: Packet): void {\n\t\tconst self = this;\n\n\t\t// ISO13818-1: Table 2-3 – PID table\n\t\tif (PAT_PID === packet.PID) {\n\t\t\t/* PAT PID */\n\t\t\tthis._parsePat(packet);\n\t\t} else if (CAT_PID === packet.PID) {\n\t\t\t/* CAT PID */\n\t\t} else if (TSDT_PID === packet.PID) {\n\t\t\t/* Transport Stream Description Table */\n\t\t} else if (0x0003 <= packet.PID && packet.PID <= 0x000f) {\n\t\t\t/* Reserved */\n\t\t} else if (SDT_PID === packet.PID) {\n\t\t\t/* Service Description Table */\n\t\t\tthis._parseSdt(packet);\n\t\t} else if (packet.PID === self.currentProgramPID) {\n\t\t\t/* PMT PID */\n\t\t\tthis._parsePmt(packet);\n\t\t}\n\t\t// else if (this.findTrack(packet.PID)) {\n\t\t// \t/* Reserved */\n\t\t// } else {\n\t\t// \tlogger.warn(`psi unknown packet PID ${packet.PID}`);\n\t\t// }\n\t}\n\n\t// findPmtProgram(PID) {\n\t// \tlet program = null;\n\t//\n\t// \tfor (let i = 0; i < this.pat_table.length; i++) {\n\t// \t\tif (this.pat_table[i].pid === PID) {\n\t// \t\t\tprogram = this.pat_table[i].id;\n\t// \t\t\tbreak;\n\t// \t\t}\n\t// \t}\n\t//\n\t// \treturn program;\n\t// }\n\n\t/**\n\t * @param PID\n\t */\n\tfindTrack(PID: number): Track {\n\t\tlet program = null;\n\t\tlet streams = this.pes_streams;\n\n\t\tfor (let i = 0; i < streams.length; i++) {\n\t\t\tif (streams[i].id === PID) {\n\t\t\t\tprogram = streams[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn program;\n\t}\n\n\t/**\n\t * Parse PAT Packet\n\t * @param pack\n\t * @private\n\t */\n\tprivate _parsePat(pack: Packet): PATSection {\n\t\tlet data: Uint8Array;\n\n\t\tif (pack.payload_unit_start_indicator) {\n\t\t\t// psi has pointer_field\n\t\t\tlet pointer = pack.payload[0];\n\n\t\t\tdata = pack.payload.subarray(pointer + 1);\n\t\t} else {\n\t\t\tdata = pack.payload;\n\t\t}\n\n\t\tlet pat = new PATSection(data);\n\n\t\t// https://tools.ietf.org/html/rfc8216#section-3.2\n\t\t// Transport Stream Segments MUST contain a single MPEG-2 Program;\n\t\tfor (var i = 0; i < pat.pmtTable.length; i++) {\n\t\t\tthis._add_pid_to_pmt(pat.pmtTable[i].programNum, pat.pmtTable[i].program_map_PID);\n\t\t}\n\n\t\treturn pat;\n\t}\n\n\t/**\n\t * Associates Program Number and Program Map Table(PMT) PID\n\t * @param programId\n\t * @param pid\n\t */\n\tprivate _add_pid_to_pmt(programId: number, pid: number): void {\n\t\tlet table = this.pat_table;\n\n\t\tfunction get_pmt(id: number) {\n\t\t\tfor (let i = 0, item: M2TS.PATTableItem; i < table.length; i++) {\n\t\t\t\titem = table[i];\n\t\t\t\tif (item.id === id) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tidx: i,\n\t\t\t\t\t\titem\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tlet p = get_pmt(programId);\n\t\tif (!p) {\n\t\t\ttable.push({\n\t\t\t\tid: programId,\n\t\t\t\tpid: pid\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Parse PMT Packet\n\t * @param pack\n\t */\n\tprivate _parsePmt(pack: Packet): PMTSection {\n\t\tlet data: Uint8Array;\n\n\t\tif (pack.payload_unit_start_indicator) {\n\t\t\t// psi has pointer_field\n\t\t\tlet pointer = pack.payload[0];\n\n\t\t\tdata = pack.payload.subarray(pointer + 1);\n\t\t} else {\n\t\t\tdata = pack.payload;\n\t\t}\n\n\t\tlet pmt = new PMTSection(data);\n\n\t\tfor (var i = 0; i < pmt.pes_table.length; i++) {\n\t\t\tthis._add_pes_stream(pmt.pes_table[i], pmt);\n\t\t}\n\n\t\treturn pmt;\n\t}\n\n\t/**\n\t * @param stream\n\t * @param pmt\n\t */\n\tprivate _add_pes_stream(stream: M2TS.PESTableItem, pmt: PMTSection): void {\n\t\tlet streams = this.pes_streams;\n\n\t\tfunction get_program(id: number) {\n\t\t\tfor (let i = 0, item: M2TS.PSI_PES_Stream; i < streams.length; i++) {\n\t\t\t\titem = streams[i];\n\t\t\t\tif (item.id === id) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tidx: i,\n\t\t\t\t\t\titem\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tlet p = get_program(stream.PID);\n\t\tif (!p) {\n\t\t\tstreams.push({\n\t\t\t\tid: stream.PID,\n\t\t\t\tstream_type: stream.streamType,\n\t\t\t\tpcr_pid: pmt.PCR_PID,\n\t\t\t\tduration: 0,\n\t\t\t\tsps: [],\n\t\t\t\tpps: [],\n\t\t\t\tpixelRatio: [1, 1],\n\t\t\t\ttimescale: 90000, // (in TS timescale = 90kHz)\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Parse SDT Packet\n\t * @param pack\n\t */\n\tprivate _parseSdt(pack: Packet): SDTSection {\n\t\tlet data: Uint8Array;\n\n\t\tif (pack.payload_unit_start_indicator) {\n\t\t\t// psi has pointer_field\n\t\t\tlet pointer = pack.payload[0];\n\n\t\t\tdata = pack.payload.subarray(pointer + 1);\n\t\t} else {\n\t\t\tdata = pack.payload;\n\t\t}\n\n\t\tlet sdt = new SDTSection(data);\n\n\t\tif (sdt.service_table.length > 0) {\n\t\t\tthis.metadata.service_name = sdt.service_table[0].name;\n\t\t\tthis.metadata.service_provider = sdt.service_table[0].provider_name;\n\t\t}\n\n\t\treturn sdt;\n\t}\n}\n\nexport default PSI;\n","/**\n * @file: complex.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Complex Stream.\n *\n * Combine Video, Audio, Caption c and other data.\n */\nimport Stream from '../../util/stream';\nimport logger from '../../util/logger';\n\nclass M2TSComplexStream extends Stream {\n\tconstructor(ctx, psi) {\n\t\tsuper();\n\n\t\t/** @private */\n\t\tthis.context = ctx;\n\n\t\t/** @private {PSI} */\n\t\tthis.PSI = psi;\n\n\t\t/** @private {Object} */\n\t\tthis.videoTrack = null;\n\n\t\t/** @private {Object} */\n\t\tthis.audioTrack = null;\n\n\t\t/** @private {Object} */\n\t\tthis.captionTrack = null;\n\n\t\t// pipe specified by outside.\n\t}\n\n\tpush(data) {\n\t\tlet tracks = data;\n\n\t\tfor (let i = 0, track; i < tracks.length; i++) {\n\t\t\ttrack = tracks[i];\n\n\t\t\tswitch (track.type) {\n\t\t\t\tcase 'video':\n\t\t\t\t\t// data -> GOPs\n\t\t\t\t\tthis._complexVideo(track);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'audio':\n\t\t\t\t\tthis._complexAudio(track);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'caption':\n\t\t\t\t\tthis._complexCaption(track);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tflush() {\n\t\tthis.emit('done');\n\n\t\tthis._clearStream();\n\t}\n\n\treset() {\n\t\tthis._clearStream();\n\n\t\t// This is demux end stream, so don't emit reset.\n\t\t// this.emit('reset');\n\t}\n\n\t_clearStream() {\n\t\tthis.videoTrack = null;\n\t\tthis.audioTrack = null;\n\t\tthis.captionTrack = null;\n\t}\n\n\t_complexVideo(gops) {\n\t\tlet track = this.PSI.findTrack(gops.trackId);\n\n\t\tif (track) {\n\t\t\ttrack.type = 'video';\n\t\t\ttrack.gops = gops;\n\t\t\ttrack.firstDTS = gops[0][0].dts;\n\t\t\ttrack.firstPTS = gops[0][0].pts;\n\t\t\t// set duration to Infinity(POSITIVE_INFINITY) can be useful for live.\n\t\t\t// If Infinity it will loose the ability to seek.\n\t\t\ttrack.duration = Number.POSITIVE_INFINITY;\n\n\t\t\tthis.videoTrack = track;\n\n\t\t\tthis.emit('data', {\n\t\t\t\tvideoTrack: this.videoTrack\n\t\t\t});\n\t\t}\n\t}\n\n\t_complexAudio(frames) {\n\t\tlet track = this.PSI.findTrack(frames.trackId);\n\n\t\tif (track) {\n\t\t\ttrack.type = 'audio';\n\t\t\ttrack.frames = frames;\n\t\t\ttrack.firstPTS = track.firstDTS = frames[0].dts;\n\n\t\t\t// set duration to Infinity(POSITIVE_INFINITY) can be useful for live.\n\t\t\t// If Infinity it will loose the ability to seek.\n\t\t\ttrack.duration = Number.POSITIVE_INFINITY;\n\n\t\t\tthis.audioTrack = track;\n\n\t\t\tthis.emit('data', {\n\t\t\t\taudioTrack: this.audioTrack\n\t\t\t});\n\t\t}\n\t}\n\n\t_complexCaption() {}\n}\n\nexport default M2TSComplexStream;\n","/**\n * @file: platform.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * @description device\n */\nconst os = {\n\tmac: false,\n\tiphone: false,\n\tandroid: false\n};\nconst browser = {\n\tversion: false,\n\tCHROME: false,\n\tSAFARI: false,\n\tFIREFOX: false,\n\tIE11: false,\n\tIE: false,\n\tEDGE: false,\n\tWECHAT: false\n};\n\nlet nav = navigator;\n// let platform = nav.platform;\nlet ua = nav.userAgent.toLowerCase();\n\nvar match =\n\t/(edge)\\/([\\w.]+)/.exec(ua) ||\n\t/(opr)[/]([\\w.]+)/.exec(ua) ||\n\t/(chrome)[ /]([\\w.]+)/.exec(ua) ||\n\t/(firefox)[ /]([\\w.]+)/.exec(ua) ||\n\t/(iemobile)[/]([\\w.]+)/.exec(ua) ||\n\t/(version)(applewebkit)[ /]([\\w.]+).*(safari)[ /]([\\w.]+)/.exec(ua) ||\n\t/(webkit)[ /]([\\w.]+).*(version)[ /]([\\w.]+).*(safari)[ /]([\\w.]+)/.exec(ua) ||\n\t/(webkit)[ /]([\\w.]+)/.exec(ua) ||\n\t/(opera)(?:.*version|)[ /]([\\w.]+)/.exec(ua) ||\n\t/(msie) ([\\w.]+)/.exec(ua) ||\n\t(ua.indexOf('trident') >= 0 && /(rv)(?::| )([\\w.]+)/.exec(ua)) ||\n\t(ua.indexOf('compatible') < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec(ua)) ||\n\t[];\n\nvar platform_match =\n\t/(ipad)/.exec(ua) ||\n\t/(ipod)/.exec(ua) ||\n\t/(windows phone)/.exec(ua) ||\n\t/(iphone)/.exec(ua) ||\n\t/(kindle)/.exec(ua) ||\n\t/(silk)/.exec(ua) ||\n\t/(android)/.exec(ua) ||\n\t/(win)/.exec(ua) ||\n\t/(mac)/.exec(ua) ||\n\t/(linux)/.exec(ua) ||\n\t/(cros)/.exec(ua) ||\n\t/(playbook)/.exec(ua) ||\n\t/(bb)/.exec(ua) ||\n\t/(blackberry)/.exec(ua) ||\n\t[];\n\nvar result = {\n\tversion: undefined\n};\nvar matched = {\n\tbrowser: match[5] || match[3] || match[1] || '',\n\tversion: match[2] || match[4] || '0',\n\tversionNumber: match[4] || match[2] || '0',\n\tplatform: platform_match[0] || ''\n};\n\nif (matched.browser) {\n\tresult[matched.browser] = true;\n\t// result.version = matched.version;\n\t// result.versionNumber = parseInt(matched.versionNumber, 10);\n\n\tlet versionArray = matched.versionNumber.split('.');\n\tresult.version = {\n\t\tmajor: parseInt(matched.versionNumber, 10),\n\t\tstring: matched.version\n\t};\n\tif (versionArray.length > 1) {\n\t\tresult.version.minor = parseInt(versionArray[1], 10);\n\t}\n\tif (versionArray.length > 2) {\n\t\tresult.version.build = parseInt(versionArray[2], 10);\n\t}\n}\n\n// -------------------------------------- browser --------------------------------------\nbrowser.version = result.version;\nbrowser.CHROME = !!result['chrome'];\nbrowser.SAFARI = !!result['safari'] && !browser.CHROME;\nbrowser.FIREFOX = !!result['firefox'];\nbrowser.IE11 = /rv:11/.test(ua);\nbrowser.IE = !!result['msie'] || browser.IE11;\nbrowser.EDGE = !!result['edge'];\nbrowser.WECHAT = /(wechat)|(micromessenger)/.test(ua);\n\n// -------------------------------------- os --------------------------------------\n\nos.mac = !!matched.platform['mac'];\nos.iphone = !!matched.platform['iphone'];\nos.android = !!matched.platform['android'];\n\nexport default {\n\tbrowser: browser,\n\tos: os\n};\n","/**\n * @file: aac-config.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Audio Config Helper\n * Accord audioObjectType/samplingFrequencyIndex/channelCount, generate mimeType info.\n */\nimport platform from '../../util/platform';\nimport logger from '../../util/logger';\n\n/*\n    sampling freq,\n    0: 96000 Hz\n    1: 88200 Hz\n    2: 64000 Hz\n    3: 48000 Hz\n    4: 44100 Hz\n    5: 32000 Hz\n    6: 24000 Hz\n    7: 22050 Hz\n    8: 16000 Hz\n    9: 12000 Hz\n    10: 11025 Hz\n    11: 8000 Hz\n    12: 7350 Hz\n    13: Reserved\n    14: Reserved\n    15: frequency is written explictly\n */\nconst samplingRates = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\n\nexport default (audioObjectType: number, samplingFrequencyIndex: number, channelCount: number) => {\n\tlet adtsExtensionSamplingIndex;\n\tlet realAudioObjectType = audioObjectType;\n\tlet config;\n\n\tif (samplingFrequencyIndex > samplingRates.length - 1) {\n\t\tlogger.error(`invalid sampling index:${samplingFrequencyIndex}`);\n\t\treturn;\n\t}\n\n\t// firefox: freq less than 24kHz = AAC SBR (HE-AAC)\n\tif (platform.browser.FIREFOX) {\n\t\tif (samplingFrequencyIndex >= 6) {\n\t\t\taudioObjectType = 5;\n\t\t\tconfig = new Array(4);\n\t\t\t// HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n\t\t\t// there is a factor 2 between frame sample rate and output sample rate\n\t\t\t// multiply frequency by 2 (see table below, equivalent to substract 3)\n\t\t\tadtsExtensionSamplingIndex = samplingFrequencyIndex - 3;\n\t\t} else {\n\t\t\taudioObjectType = 2;\n\t\t\tconfig = new Array(2);\n\t\t\tadtsExtensionSamplingIndex = samplingFrequencyIndex;\n\t\t}\n\t\t// Android : always use AAC\n\t} else if (platform.os.android) {\n\t\taudioObjectType = 2;\n\t\tconfig = new Array(2);\n\t\tadtsExtensionSamplingIndex = samplingFrequencyIndex;\n\t} else {\n\t\t/*  for other browsers (Chrome/Vivaldi/Opera ...)\n\t\t\t\talways force audio type to be HE-AAC SBR, as some browsers do not support audio codec switch properly (like Chrome ...)\n\t\t\t*/\n\t\taudioObjectType = 5;\n\t\tconfig = new Array(4);\n\t\t// if (manifest codec is HE-AAC or HE-AACv2) OR (manifest codec not specified AND frequency less than 24kHz)\n\t\tif (samplingFrequencyIndex >= 6) {\n\t\t\t// HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n\t\t\t// there is a factor 2 between frame sample rate and output sample rate\n\t\t\t// multiply frequency by 2 (see table below, equivalent to substract 3)\n\t\t\tadtsExtensionSamplingIndex = samplingFrequencyIndex - 3;\n\t\t} else {\n\t\t\t// if (manifest codec is AAC) AND (frequency less than 24kHz AND nb channel is 1) OR (manifest codec not specified and mono audio)\n\t\t\t// Chrome fails to play back with low frequency AAC LC mono when initialized with HE-AAC.  This is not a problem with stereo.\n\t\t\tif (channelCount === 1) {\n\t\t\t\taudioObjectType = 2;\n\t\t\t\tconfig = new Array(2);\n\t\t\t}\n\t\t\tadtsExtensionSamplingIndex = samplingFrequencyIndex;\n\t\t}\n\t}\n\t/* \n        refer to http://wiki.multimedia.cx/index.php?title=MPEG-4_Audio#Audio_Specific_Config ISO 14496-3 (AAC).pdf \n            - Table 1.13 — Syntax of AudioSpecificConfig()\n\t\t  Audio Profile / Audio Object Type\n\t\t  0: Null\n\t\t  1: AAC Main\n\t\t  2: AAC LC (Low Complexity)\n\t\t  3: AAC SSR (Scalable Sample Rate)\n\t\t  4: AAC LTP (Long Term Prediction)\n\t\t  5: SBR (Spectral Band Replication)\n\t\t  6: AAC Scalable\n\n\t\t  Channel Configurations\n\t\t  These are the channel configurations:\n\t\t  0: Defined in AOT Specifc Config\n\t\t  1: 1 channel: front-center\n\t\t  2: 2 channels: front-left, front-right\n\t\t*/\n\t// audioObjectType = profile => profile, the MPEG-4 Audio Object Type minus 1\n\tconfig[0] = audioObjectType << 3;\n\t// samplingFrequencyIndex\n\tconfig[0] |= (samplingFrequencyIndex & 0x0e) >> 1;\n\tconfig[1] |= (samplingFrequencyIndex & 0x01) << 7;\n\t// channelConfiguration\n\tconfig[1] |= channelCount << 3;\n\tif (audioObjectType === 5) {\n\t\t// adtsExtensionSamplingIndex\n\t\tconfig[1] |= (adtsExtensionSamplingIndex & 0x0e) >> 1;\n\t\tconfig[2] = (adtsExtensionSamplingIndex & 0x01) << 7;\n\t\t// audioObjectType (force to 2, chrome is checking that object type is less than 5 ???\n\t\t//    https://chromium.googlesource.com/chromium/src.git/+/master/media/formats/mp4/aac.cc\n\t\tconfig[2] |= 2 << 2;\n\t\tconfig[3] = 0;\n\t}\n\n\treturn {\n\t\tconfig: config,\n\t\tsampleRate: samplingRates[samplingFrequencyIndex],\n\t\tchannelCount: channelCount,\n\t\tcodec: 'mp4a.40.' + audioObjectType,\n\t\trealCodec: 'mp4a.40.' + realAudioObjectType\n\t};\n};\n","/**\n * @file: created at Saturday, 9th May 2020 11:13:19 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n// The AudioSpecificConfig is explained in ISO 14496-3.\nexport interface AudioSpecificConfig {\n\taudioObjectType: number;\n\tsampleCount: number;\n\tchannelConfiguration: number;\n\tsampleRate: number;\n\tsamplingFrequencyIndex: number;\n\t// assume ISO/IEC 14496-12 AudioSampleEntry default of 16\n}\n\nexport interface AACFrame extends Omit<AudioSpecificConfig, 'channelConfiguration'> {\n\tpts: number;\n\tdts: number;\n\tdata: Uint8Array;\n\tchannelCount: number; // equal to channelConfiguration\n\tsampleSize: number;\n}\n\nexport const AAC_SAMPLING_FREQUENCIES = [\n\t96000,\n\t88200,\n\t64000,\n\t48000,\n\t44100,\n\t32000,\n\t24000,\n\t22050,\n\t16000,\n\t12000,\n\t11025,\n\t8000,\n\t7350\n];\n","/**\n * @file: adts.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * ADTS codec\n * Wiki Refer: https://wiki.multimedia.cx/index.php?title=ADTS\n */\nimport EventEmitter from '../util/event-emitter';\nimport { AACFrame, AAC_SAMPLING_FREQUENCIES } from './aac/aac';\n\nexport type AACCodecData = {\n\tpts: number;\n\tdts: number;\n\tpayload: Uint8Array;\n};\n\n/**\n * @extends EventEmitter\n */\nclass ADTSCodec extends EventEmitter {\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\tpush(data: AACCodecData) {\n\t\tlet { pts, dts, payload } = data;\n\t\tlet data_byte = payload;\n\t\tlet i = 0,\n\t\t\tframeNum = 0,\n\t\t\tframeLength,\n\t\t\tprotectionSkipBytes,\n\t\t\tframeEnd,\n\t\t\tsampleCount,\n\t\t\tadtsFrameDuration;\n\n\t\twhile (i + 5 < data_byte.length) {\n\t\t\t// Look for the start of an ADTS header..\n\t\t\tif (data_byte[i] !== 0xff || (data_byte[i + 1] & 0xf6) !== 0xf0) {\n\t\t\t\t// If a valid header was not found,  jump one forward and attempt to\n\t\t\t\t// find a valid ADTS header starting at the next byte\n\t\t\t\ti++;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// The protection skip bit tells us if we have 2 bytes of CRC data at the\n\t\t\t// end of the ADTS header\n\t\t\tprotectionSkipBytes = (~data_byte[i + 1] & 0x01) * 2;\n\n\t\t\t// Frame length is a 13 bit integer starting 16 bits from the\n\t\t\t// end of the sync sequence\n\t\t\tframeLength =\n\t\t\t\t((data_byte[i + 3] & 0x03) << 11) | (data_byte[i + 4] << 3) | ((data_byte[i + 5] & 0xe0) >> 5);\n\n\t\t\tsampleCount = ((data_byte[i + 6] & 0x03) + 1) * 1024;\n\t\t\tadtsFrameDuration = (sampleCount * 90000) / AAC_SAMPLING_FREQUENCIES[(data_byte[i + 2] & 0x3c) >>> 2];\n\n\t\t\tframeEnd = i + frameLength;\n\n\t\t\t// If we don't have enough data to actually finish this ADTS frame, return\n\t\t\t// and wait for more data\n\t\t\tif (data_byte.byteLength < frameEnd) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet aacFrame: AACFrame = {\n\t\t\t\tpts: pts + frameNum * adtsFrameDuration,\n\t\t\t\tdts: dts + frameNum * adtsFrameDuration,\n\t\t\t\tsampleCount: sampleCount,\n\t\t\t\taudioObjectType: ((data_byte[i + 2] >>> 6) & 0x03) + 1,\n\t\t\t\tchannelCount: ((data_byte[i + 2] & 1) << 2) | ((data_byte[i + 3] & 0xc0) >>> 6),\n\t\t\t\tsampleRate: AAC_SAMPLING_FREQUENCIES[(data_byte[i + 2] & 0x3c) >>> 2],\n\t\t\t\tsamplingFrequencyIndex: (data_byte[i + 2] & 0x3c) >>> 2,\n\t\t\t\t// assume ISO/IEC 14496-12 AudioSampleEntry default of 16\n\t\t\t\tsampleSize: 16,\n\t\t\t\tdata: data_byte.subarray(i + 7 + protectionSkipBytes, frameEnd)\n\t\t\t};\n\t\t\t// Otherwise, deliver the complete AAC frame\n\t\t\tthis.emit('frame', aacFrame);\n\n\t\t\t// If the data_byte is empty, clear it and return\n\t\t\tif (data_byte.byteLength === frameEnd) {\n\t\t\t\tdata_byte = undefined;\n\n\t\t\t\tthis.emit('done');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tframeNum++;\n\n\t\t\t// Remove the finished frame from the data_byte and start the process again\n\t\t\tdata_byte = data_byte.subarray(frameEnd);\n\t\t}\n\t}\n}\n\nexport default ADTSCodec;\n","/**\n * @file: adts.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * ADTS(Audio Data Transport Stream) Stream.\n */\nimport { AACFrame } from '../../codec/aac/aac';\nimport getAudioConfig from '../../codec/aac/aac-config';\nimport ADTSCodec from '../../codec/adts';\nimport StreamType from '../../enum/stream-types';\nimport Stream from '../../util/stream';\nimport PSI from '../psi';\nimport { AACFrameList, PESStreamEmitData } from '../types/pipeline';\n\nclass ADTSStream extends Stream {\n\tprivate PSI: PSI;\n\tprivate trackId?: number;\n\tprivate codec: ADTSCodec;\n\tprivate frames: AACFrameList;\n\n\tconstructor(psi: PSI) {\n\t\tsuper();\n\n\t\tthis.PSI = psi;\n\t\tthis.trackId = null;\n\n\t\t/** @private {ADTSCodec} */\n\t\tthis.codec = new ADTSCodec();\n\n\t\tthis.codec.on('frame', (frame: AACFrame) => {\n\t\t\tthis.frames.push(frame);\n\t\t\tthis.frames.byteLength += frame.data.byteLength;\n\t\t\tthis.frames.trackId = this.trackId;\n\t\t});\n\n\t\tthis._newFrames();\n\t}\n\n\tpush(data: PESStreamEmitData) {\n\t\tif (data.stream_type === StreamType.ADTS) {\n\t\t\tthis.trackId = data.pid;\n\n\t\t\tthis.codec.push({\n\t\t\t\tdts: data.pes.DTS,\n\t\t\t\tpts: data.pes.PTS,\n\t\t\t\tpayload: data.pes.data_byte\n\t\t\t});\n\t\t}\n\t}\n\n\tflush() {\n\t\tif (this.frames.length > 0) {\n\t\t\tlet count = this.frames.length;\n\t\t\tlet firstFrame = this.frames[0];\n\t\t\tlet lastFrame = this.frames[count - 1];\n\t\t\tlet lastDuration = (lastFrame.sampleRate * lastFrame.sampleCount) / 90000;\n\n\t\t\tthis.frames.firstDTS = firstFrame.dts;\n\t\t\tthis.frames.firstPTS = firstFrame.pts;\n\n\t\t\tif (count === 1) {\n\t\t\t\tthis.frames.duration = lastDuration;\n\t\t\t} else {\n\t\t\t\tthis.frames.duration = lastDuration + (lastFrame.pts - firstFrame.pts);\n\t\t\t}\n\n\t\t\t// To prevent information mismatch leading to next pipeline decoding errors\n\t\t\t// Every audio frame list assembly needs to update track meta.\n\t\t\tthis._updateTrackMeta(firstFrame);\n\n\t\t\tthis.emit('data', this.frames);\n\n\t\t\tthis.reset();\n\t\t\tthis.emit('done');\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.trackId = null;\n\t\tthis._newFrames();\n\t}\n\n\t_newFrames() {\n\t\tthis.frames = []; // aac frames\n\t\tthis.frames.type = 'audio';\n\t\tthis.frames.byteLength = 0;\n\t\tthis.frames.duration = 0;\n\t\tthis.frames.firstDTS = 0;\n\t\tthis.frames.firstPTS = 0;\n\t}\n\n\t/**\n\t * @param {Object} frame\n\t */\n\t_updateTrackMeta(frame: AACFrame) {\n\t\tlet track = this.PSI.findTrack(this.trackId);\n\t\tlet config = getAudioConfig(frame.audioObjectType, frame.samplingFrequencyIndex, frame.channelCount);\n\t\ttrack.config = config.config;\n\t\ttrack.sampleRate = config.sampleRate;\n\t\ttrack.inputTimeScale = track.inputTimeScale || track.timescale;\n\t\ttrack.timescale = config.sampleRate;\n\t\ttrack.channelCount = config.channelCount;\n\t\ttrack.codec = config.codec;\n\t\ttrack.realCodec = config.realCodec;\n\t\ttrack.isAAC = true;\n\t}\n}\n\nexport default ADTSStream;\n","/**\n * @file: ep3b.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * discard the emulation_prevention_three_byte\n * @param data\n */\nexport default function discardEP3B(data: Uint8Array): Uint8Array {\n\tlet length = data.byteLength,\n\t\temulationPreventionBytesPositions = [],\n\t\ti = 1,\n\t\tnewLength: number,\n\t\tnewData = new Uint8Array(0);\n\n\t// Find all `Emulation Prevention Bytes`\n\twhile (i < length - 2) {\n\t\tif (data[i] === 0 && data[i + 1] === 0 && data[i + 2] === 0x03) {\n\t\t\temulationPreventionBytesPositions.push(i + 2);\n\t\t\ti += 2;\n\t\t} else {\n\t\t\ti++;\n\t\t}\n\t}\n\n\t// If no Emulation Prevention Bytes were found just return the original\n\t// array\n\tif (emulationPreventionBytesPositions.length === 0) {\n\t\treturn data;\n\t}\n\n\t// Create a new array to hold the NAL unit data\n\tnewLength = length - emulationPreventionBytesPositions.length;\n\n\ttry {\n\t\tnewData = new Uint8Array(newLength);\n\t} catch (e) {\n\t\tthrow `epsb alloc mem error ${newLength}`;\n\t}\n\tlet sourceIndex = 0;\n\n\tfor (i = 0; i < newLength; sourceIndex++, i++) {\n\t\tif (sourceIndex === emulationPreventionBytesPositions[0]) {\n\t\t\t// Skip this byte\n\t\t\tsourceIndex++;\n\t\t\t// Remove this position index\n\t\t\temulationPreventionBytesPositions.shift();\n\t\t}\n\t\tnewData[i] = data[sourceIndex];\n\t}\n\n\treturn newData;\n}\n","/**\n * @file: exp-golumb.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * exp golumb algorithm.\n * codeNum = 2leadingZeroBits – 1 + read_bits( leadingZeroBits )\n * @see https://en.wikipedia.org/wiki/Exponential-Golomb_coding\n */\n\n/**\n * read n bit.\n * @param buffer\n * @param bitOffset\n * @param length\n * @private\n */\nexport function readBit(buffer: Uint8Array, bitOffset: number = 0, length: number = 1): number {\n\tlet startByte = 0;\n\tlet startByteBitPos = 0;\n\tlet val = 0;\n\tlet bitStr = '',\n\t\tbitVal = 0;\n\n\tfor (let j = bitOffset; j < bitOffset + length; j++) {\n\t\tstartByte = Math.floor(j / 8);\n\t\tstartByteBitPos = 7 - (j % 8);\n\t\tbitVal = (buffer[startByte] >> startByteBitPos) & 0x01;\n\n\t\tbitStr += bitVal;\n\t}\n\n\tval = parseInt(bitStr, 2);\n\n\treturn val;\n}\n\n/**\n * read 1 byte.\n * @param buffer\n * @param bitOffset\n */\nexport function readByte(buffer: Uint8Array, bitOffset: number = 0) {\n\treturn readBit(buffer, bitOffset, 8);\n}\n\n/**\n * Unsigned Integer Exp-Golomb Coded.\n * @param buffer\n * @param bitOffset\n */\nexport function readUEV(buffer: Uint8Array, bitOffset: number = 0) {\n\tlet leadingZeros = [];\n\tlet bitLength = buffer.byteLength * 8;\n\tlet readBit1 = false;\n\tlet startByte = 0;\n\tlet startByteBitPos = 0;\n\tlet bitVal = 0;\n\tlet value = '';\n\n\t// 1. 计算 leadingZeros\n\tfor (let i = bitOffset; i < bitLength; i++) {\n\t\tstartByte = Math.floor(i / 8);\n\t\tstartByteBitPos = 7 - (i % 8);\n\n\t\tbitVal = (buffer[startByte] >> startByteBitPos) & 0x01;\n\n\t\tif (!readBit1) {\n\t\t\tif (bitVal === 0) {\n\t\t\t\tleadingZeros.push(0);\n\t\t\t} else {\n\t\t\t\treadBit1 = true;\n\t\t\t\tbitOffset = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tlet codeNumLength = leadingZeros.length + 1;\n\n\t// 2. 计算有效位数值\n\tfor (let j = bitOffset; j < bitOffset + codeNumLength; j++) {\n\t\tstartByte = Math.floor(j / 8);\n\t\tstartByteBitPos = 7 - (j % 8);\n\t\tbitVal = (buffer[startByte] >> startByteBitPos) & 0x01;\n\n\t\tvalue += bitVal;\n\t}\n\n\treturn {\n\t\tbitLength: leadingZeros.length + codeNumLength,\n\t\tvalue: parseInt(value, 2) - 1\n\t};\n}\n\n/**\n * Signed Integer Exp-Golomb Coded.\n * @param buffer\n * @param bitOffset\n */\nexport function readSEV(buffer: Uint8Array, bitOffset: number = 0) {\n\tlet uev = readUEV(buffer, bitOffset);\n\tlet codeNum = uev.value;\n\n\tlet signedValue = Math.pow(-1, codeNum + 1) * Math.ceil(codeNum / 2);\n\n\treturn {\n\t\tbitLength: uev.bitLength,\n\t\tvalue: signedValue\n\t};\n}\n\nexport default {\n\treadUEV,\n\treadSEV,\n\treadBit,\n\treadByte\n};\n","/**\n * @file: sps.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport ExpGolomb from '../../util/exp-golumb';\n\nlet bitOffset = 0;\n\nexport type SPSProps = {\n\tprofile_idc: number;\n\tprofile_compatibility: number;\n\tlevel_idc: number;\n\tsps_id: number;\n\tlog2_max_frame_num_minus4: number;\n\tpic_order_cnt_type: number;\n\tlog2_max_pic_order_cnt_lsb_minus4: number;\n\n\twidth: number;\n\theight: number;\n\n\tpixelRatio: [number, number];\n\tpayload: Uint8Array;\n\n\tvideo_format: number;\n\n\tfps: number;\n\tfixedFPS: boolean;\n};\n\n/**\n * 7.3.2.1.1.1 Scaling list syntax\n * @param scalingList\n * @param size\n */\nfunction scaling_list(scalingList, size) {\n\tlet lastScale = 8;\n\tlet nextScale = 8;\n\tlet delta_scale;\n\n\tfor (var j = 0; j < size; j++) {\n\t\tif (nextScale != 0) {\n\t\t\tdelta_scale = ExpGolomb.readUEV(scalingList, bitOffset);\n\t\t\tbitOffset += delta_scale.bitLength;\n\n\t\t\tnextScale = (lastScale + delta_scale.value + 256) % 256;\n\t\t}\n\n\t\tlastScale = scalingList[j];\n\t}\n}\n\n/**\n * decode (SPS)Sequence parameter set\n * @param payload\n */\nexport function decodeSPS(payload: Uint8Array): SPSProps {\n\tbitOffset = 0;\n\n\tlet profile_idc = payload[0];\n\tlet profile_compatibility = payload[1];\n\tlet level_idc = payload[2];\n\tlet golombBuffer = payload.subarray(3);\n\tlet separate_colour_plane_flag = 0,\n\t\tqpprime_y_zero_transform_bypass_flag = 0,\n\t\tseq_scaling_matrix_present_flag = 0;\n\tlet lmpoclmUEV;\n\tlet delta_pic_order_always_zero_flag = 0,\n\t\tofnrpSEV,\n\t\tofttbfSEV,\n\t\tnrfipoccUEV;\n\tlet pixelRatio: [number, number] = [1, 1],\n\t\tpixelScale = 1;\n\tlet video_format: number;\n\tlet fps = 0,\n\t\tnum_units_in_tick: number,\n\t\ttime_scale: number,\n\t\tfixed_frame_rate_flag: boolean = true;\n\n\t// seq_parameter_set_id\n\tlet spsUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += spsUEV.bitLength;\n\n\tif (\n\t\tprofile_idc == 100 ||\n\t\tprofile_idc == 110 ||\n\t\tprofile_idc == 122 ||\n\t\tprofile_idc == 244 ||\n\t\tprofile_idc == 44 ||\n\t\tprofile_idc == 83 ||\n\t\tprofile_idc == 86 ||\n\t\tprofile_idc == 118 ||\n\t\tprofile_idc == 128\n\t) {\n\t\t// chroma_format_idc\n\t\tlet chromaFIUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += chromaFIUEV.bitLength;\n\n\t\tif (chromaFIUEV.value == 3) {\n\t\t\t// separate_colour_plane_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\t\tbitOffset += 1;\n\t\t}\n\n\t\t// bit_depth_luma_minus8\n\t\tlet bitdlmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += bitdlmUEV.bitLength;\n\n\t\t// bit_depth_chroma_minus8\n\t\tlet bitdcmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += bitdcmUEV.bitLength;\n\n\t\t// qpprime_y_zero_transform_bypass_flag\n\t\t// qpprime_y_zero_transform_bypass_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\tbitOffset += 1;\n\n\t\t// seq_scaling_matrix_present_flag\n\t\tseq_scaling_matrix_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\tbitOffset += 1;\n\n\t\tif (seq_scaling_matrix_present_flag) {\n\t\t\tfor (let i = 0; i < (chromaFIUEV.value != 3 ? 8 : 12); i++) {\n\t\t\t\tlet seq_scaling_list_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\t\t\tbitOffset += 1;\n\n\t\t\t\tif (seq_scaling_list_present_flag) {\n\t\t\t\t\tif (i < 6) {\n\t\t\t\t\t\tscaling_list(golombBuffer, 16);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscaling_list(golombBuffer, 64);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// log2_max_frame_num_minus4\n\tlet lmfnmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += lmfnmUEV.bitLength;\n\n\t// pic_order_cnt_type\n\tlet poctUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tlet pic_order_cnt_type = poctUEV.value;\n\tbitOffset += poctUEV.bitLength;\n\n\tif (pic_order_cnt_type === 0) {\n\t\t// log2_max_pic_order_cnt_lsb_minus4\n\t\tlmpoclmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += lmpoclmUEV.bitLength;\n\t} else if (pic_order_cnt_type === 1) {\n\t\t// delta_pic_order_always_zero_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\tbitOffset += 1;\n\n\t\t// offset_for_non_ref_pic\n\t\tofnrpSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n\t\tbitOffset += ofnrpSEV.bitLength;\n\n\t\t// offset_for_top_to_bottom_field\n\t\tofttbfSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n\t\tbitOffset += ofttbfSEV.bitLength;\n\n\t\t// num_ref_frames_in_pic_order_cnt_cycle\n\t\tnrfipoccUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += nrfipoccUEV.bitLength;\n\n\t\t// let offset_for_ref_frames = [];\n\t\tfor (let i = 0, item; i < nrfipoccUEV.value; i++) {\n\t\t\titem = ExpGolomb.readSEV(golombBuffer, bitOffset);\n\t\t\tbitOffset += item.bitLength;\n\n\t\t\t// offset_for_ref_frames.push(item);\n\t\t}\n\t}\n\n\t// max_num_ref_frames\n\t// 指定参考帧队列可能达到的最大长度，解码器依照这个句法元素的值开辟存储区，这个存储区用于存放已解码的参考帧，\n\t// H.264 规定最多可用 16 个参考帧，本句法元素的值最大为 16。值得注意的是这个长度以帧为单位，如果在场模式下，应该相应地扩展一倍\n\tlet mnrfUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += mnrfUEV.bitLength;\n\n\t// gaps_in_frame_num_value_allowed_flag\n\t// let gaps_in_frame_num_value_allowed_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\n\t// pic_width_in_mbs_minus1\n\tlet picWidthUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += picWidthUEV.bitLength;\n\n\t// pic_height_in_map_units_minus1\n\tlet picHeightUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += picHeightUEV.bitLength;\n\n\t// frame_mbs_only_flag\n\t// 本句法元素等于 1 时, 表示本序列中所有图像的编码模式都是帧编码；\n\t// 本句法元素等于 0 时, 表示本序列中图像的编码模式可能是帧，也可能是场或帧场自适应，某个图像具体是哪一种要由其他句法元素决定。\n\tlet frame_mbs_only_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\n\tif (!frame_mbs_only_flag) {\n\t\t// mb_adaptive_frame_field_flag (Unused, Unnecessary to read it.)\n\t\t// ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\tbitOffset += 1;\n\t}\n\n\t// direct_8x8_inference_flag,  用于指明 B 片的直接 和 skip 模式下运动矢量的预测方法\n\t// let direct_8x8_inference_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\n\t// frame_cropping_flag, 用于指明解码器是否要将图像裁剪后输出，如果是的话，后面紧跟着的四个句法元素分别指出左右、上下裁剪的宽度\n\tlet frame_cropping_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\n\tlet cropLeft = 0,\n\t\tcropRight = 0,\n\t\tcropTop = 0,\n\t\tcropBottom = 0;\n\tif (frame_cropping_flag) {\n\t\tlet fcloUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += fcloUEV.bitLength;\n\t\tcropLeft = fcloUEV.value;\n\n\t\tlet fcroUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += fcroUEV.bitLength;\n\t\tcropRight = fcroUEV.value;\n\n\t\tlet fctoUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += fctoUEV.bitLength;\n\t\tcropTop = fctoUEV.value;\n\n\t\tlet fcboUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += fcboUEV.bitLength;\n\t\tcropBottom = fcboUEV.value;\n\t}\n\n\t// vui_parameters_present_flag\n\tlet vui_parameters_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\n\tif (vui_parameters_present_flag) {\n\t\t// Annex E, E.1.1 VUI parameters syntax\n\t\t// VUI 用以表征视频格式等额外信息\n\t\t// aspect_ratio, video_format\n\n\t\tlet aspect_ratio_info_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\tbitOffset += 1;\n\n\t\tif (aspect_ratio_info_present_flag) {\n\t\t\tconst aspectRatioIdc = ExpGolomb.readByte(golombBuffer, bitOffset);\n\t\t\tbitOffset += 8;\n\n\t\t\tswitch (aspectRatioIdc) {\n\t\t\t\tcase 1:\n\t\t\t\t\tpixelRatio = [1, 1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tpixelRatio = [12, 11];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tpixelRatio = [10, 11];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tpixelRatio = [16, 11];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 5:\n\t\t\t\t\tpixelRatio = [40, 33];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 6:\n\t\t\t\t\tpixelRatio = [24, 11];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 7:\n\t\t\t\t\tpixelRatio = [20, 11];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 8:\n\t\t\t\t\tpixelRatio = [32, 11];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 9:\n\t\t\t\t\tpixelRatio = [80, 33];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 10:\n\t\t\t\t\tpixelRatio = [18, 11];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 11:\n\t\t\t\t\tpixelRatio = [15, 11];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 12:\n\t\t\t\t\tpixelRatio = [64, 33];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 13:\n\t\t\t\t\tpixelRatio = [160, 99];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 14:\n\t\t\t\t\tpixelRatio = [4, 3];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 15:\n\t\t\t\t\tpixelRatio = [3, 2];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 16:\n\t\t\t\t\tpixelRatio = [2, 1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 255: {\n\t\t\t\t\tlet width0 = ExpGolomb.readByte(golombBuffer, bitOffset);\n\t\t\t\t\tbitOffset += 8;\n\t\t\t\t\tlet width1 = ExpGolomb.readByte(golombBuffer, bitOffset);\n\t\t\t\t\tbitOffset += 8;\n\t\t\t\t\tlet height0 = ExpGolomb.readByte(golombBuffer, bitOffset);\n\t\t\t\t\tbitOffset += 8;\n\t\t\t\t\tlet height1 = ExpGolomb.readByte(golombBuffer, bitOffset);\n\t\t\t\t\tbitOffset += 8;\n\t\t\t\t\tpixelRatio = [(width0 << 8) | width1, (height0 << 8) | height1];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (pixelRatio) {\n\t\t\t\tpixelScale = pixelRatio[0] / pixelRatio[1];\n\t\t\t}\n\n\t\t\tif (aspectRatioIdc === 255) {\n\t\t\t\t// sar_width\n\t\t\t\tbitOffset += 16;\n\t\t\t\t// sar_height\n\t\t\t\tbitOffset += 16;\n\t\t\t}\n\t\t}\n\n\t\tlet overscan_info_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\tbitOffset += 1;\n\n\t\tif (overscan_info_present_flag) {\n\t\t\tbitOffset += 1;\n\t\t\t// overscan_appropriate_flag;\n\t\t}\n\n\t\tlet video_signal_type_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\tbitOffset += 1;\n\n\t\tif (video_signal_type_present_flag) {\n\t\t\t/*\n                Table E-2 – Meaning of video_format\n                video_format    Meaning\n                0               Component\n                1               PAL\n                2               NTSC\n                3               SECAM\n                4               MAC\n                5               Unspecified video format\n                6               Reserved\n                7               Reserved\n             */\n\t\t\tvideo_format = ExpGolomb.readBit(golombBuffer, bitOffset, 3);\n\t\t\tbitOffset += 3;\n\n\t\t\t// switch (video_format) {\n\t\t\t// }\n\n\t\t\t// let video_full_range_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\t\tbitOffset += 1;\n\n\t\t\tlet colour_description_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\t\tbitOffset += 1;\n\n\t\t\tif (colour_description_present_flag) {\n\t\t\t\t// colour_primaries            u(8)\n\t\t\t\t// transfer_characteristics    u(8)\n\t\t\t\t// matrix_coefficients         u(8)\n\t\t\t\tbitOffset += 24;\n\t\t\t}\n\t\t}\n\n\t\tlet chroma_loc_info_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\tbitOffset += 1;\n\n\t\tif (chroma_loc_info_present_flag) {\n\t\t\tlet chroma_sample_loc_type_top_field = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\t\tbitOffset += chroma_sample_loc_type_top_field.bitLength;\n\n\t\t\tlet chroma_sample_loc_type_bottom_field = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\t\tbitOffset += chroma_sample_loc_type_bottom_field.bitLength;\n\t\t}\n\n\t\tlet timing_info_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\tbitOffset += 1;\n\n\t\tif (timing_info_present_flag) {\n\t\t\tnum_units_in_tick = ExpGolomb.readBit(golombBuffer, bitOffset, 32);\n\t\t\tbitOffset += 32;\n\n\t\t\ttime_scale = ExpGolomb.readBit(golombBuffer, bitOffset, 32);\n\t\t\tbitOffset += 32;\n\n\t\t\tfixed_frame_rate_flag = !!ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\t\tbitOffset += 1;\n\n\t\t\tfps = time_scale / (num_units_in_tick * 2);\n\t\t}\n\n\t\t// There is left VUI other's parameters to be decoded ...\n\t\t// For now, it is useless, so don't pass them.\n\t}\n\n\t// let FrameHeightInMbs = (2 - frame_mbs_only_flag) * (picHeightUEV.value + 1);\n\t// PicSizeInMapUnits = PicWidthInMbs * PicHeightInMapUnits\n\n\treturn {\n\t\tpayload: golombBuffer,\n\n\t\tprofile_idc,\n\t\tprofile_compatibility,\n\t\tlevel_idc,\n\t\tsps_id: spsUEV.value, // ue(v)\n\t\tlog2_max_frame_num_minus4: poctUEV.value, // ue(v)\n\t\tpic_order_cnt_type, // ue(v)\n\t\tlog2_max_pic_order_cnt_lsb_minus4: lmpoclmUEV ? lmpoclmUEV.value : 0, // ue(v)\n\n\t\twidth: Math.ceil(((picWidthUEV.value + 1) * 16 - cropLeft * 2 - cropRight * 2) * pixelScale), // PicWidthInSamplesL = PicWidthInMbs * 16\n\t\theight: (2 - frame_mbs_only_flag) * (picHeightUEV.value + 1) * 16 - cropTop * 2 - cropBottom * 2,\n\n\t\tpixelRatio,\n\t\tvideo_format,\n\n\t\tfps,\n\t\tfixedFPS: fixed_frame_rate_flag\n\t};\n}\n","/**\n * @file: pps.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport ExpGolomb from '../../util/exp-golumb';\n\nexport type PPSProps = {\n\tsliceGroupNum: number;\n};\n\n/**\n * decode (PPS)Picture parameter set\n * @param payload\n */\nexport function decodePPS(payload: Uint8Array): PPSProps {\n\tlet bitOffset = 0;\n\n\tlet golombBuffer = payload;\n\tlet slice_group_change_direction_flag = 0,\n\t\tsliceGroupIds = [];\n\tlet sgcdfUEV, picSizeUEV;\n\tlet i = 0;\n\n\t// pic_parameter_set_id\n\tlet ppsUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += ppsUEV.bitLength;\n\n\t// seq_parameter_set_id\n\tlet spsUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += spsUEV.bitLength;\n\n\t// entropy_coding_mode_flag\n\t// 0: Exp-Golomb coded, see subclause 9.1 or CAVLC, see subclause 9.2\n\t// 1: CABAC, see subclause 9.3\n\tlet entropy_coding_mode_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\n\t// bottom_field_pic_order_in_frame_present_flag\n\tlet bottom_field_pic_order_in_frame_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\n\t// num_slice_groups_minus1,\n\tlet sliceGroupUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += sliceGroupUEV.bitLength;\n\n\tif (sliceGroupUEV.value > 0) {\n\t\t// slice_group_map_type\n\t\tlet sgmtUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\tbitOffset += sgmtUEV.bitLength;\n\n\t\tlet iGroup = 0,\n\t\t\titemUev;\n\n\t\tswitch (sgmtUEV.value) {\n\t\t\tcase 0:\n\t\t\t\tfor (iGroup = 0; iGroup <= sgmtUEV.value; iGroup++) {\n\t\t\t\t\t// run_length_minus1\n\t\t\t\t\titemUev = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\t\t\t\tbitOffset += itemUev.bitLength;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tfor (iGroup = 0; iGroup <= sgmtUEV.value; iGroup++) {\n\t\t\t\t\t// top_left\n\t\t\t\t\titemUev = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\t\t\t\tbitOffset += itemUev.bitLength;\n\t\t\t\t\t// bottom_right\n\t\t\t\t\titemUev = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\t\t\t\tbitOffset += itemUev.bitLength;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\tcase 4:\n\t\t\tcase 5:\n\t\t\t\t// slice_group_change_direction_flag\n\t\t\t\tslice_group_change_direction_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\t\t\t\tbitOffset += 1;\n\t\t\t\t// slice_group_change_rate_minus1\n\t\t\t\tsgcdfUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\t\t\tbitOffset += sgcdfUEV.bitLength;\n\t\t\t\tbreak;\n\t\t\tcase 6:\n\t\t\t\t{\n\t\t\t\t\t// pic_size_in_map_units_minus1\n\t\t\t\t\tpicSizeUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\t\t\t\t\tbitOffset += picSizeUEV.bitLength;\n\n\t\t\t\t\tlet length = Math.ceil(Math.log2(sliceGroupUEV.value + 1));\n\t\t\t\t\tfor (i = 0; i <= picSizeUEV.value; i++) {\n\t\t\t\t\t\t// pic_size_in_map_units_minus1\n\t\t\t\t\t\tsliceGroupIds.push(ExpGolomb.readBit(golombBuffer, bitOffset, length));\n\t\t\t\t\t\tbitOffset += length;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t// num_ref_idx_l0_default_active_minus1\n\tlet nril0dcmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += nril0dcmUEV.bitLength;\n\n\t// num_ref_idx_l1_default_active_minus1\n\tlet nril1dcmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n\tbitOffset += nril1dcmUEV.bitLength;\n\n\t// weighted_pred_flag\n\tlet weighted_pred_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\n\t// weighted_bipred_idc\n\tlet weighted_bipred_idc = ExpGolomb.readBit(golombBuffer, bitOffset, 2);\n\tbitOffset += 1;\n\n\t// pic_init_qp_minus26\n\tlet piqpSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n\tbitOffset += piqpSEV.bitLength;\n\t// pic_init_qs_minus26\n\tlet piqsSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n\tbitOffset += piqsSEV.bitLength;\n\t// chroma_qp_index_offset\n\tlet cqioSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n\tbitOffset += cqioSEV.bitLength;\n\n\tlet deblocking_filter_control_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\tlet constrained_intra_pred_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\tlet redundant_pic_cnt_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n\tbitOffset += 1;\n\n\t// if( more_rbsp_data( ) ) {\n\t//     // Unused data...\n\t// }\n\n\treturn {\n\t\tsliceGroupNum: sliceGroupUEV.value + 1\n\t};\n}\n","/**\n * @file: pps.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nexport type SEIProps = {};\n\n/**\n * decode (SEI)Supplemental enhancement information\n * @param payload\n */\nexport function decodeSEI(payload: Uint8Array): SEIProps {\n\treturn {};\n}\n","/**\n * @file: nalu.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport DataViewReader from '../../util/dv';\nimport NaluTypes from '../../enum/nalu-types';\nimport discardEP3B from './ep3b';\nimport { decodeSPS, SPSProps } from './sps';\nimport { decodePPS, PPSProps } from './pps';\nimport { decodeSEI, SEIProps } from './sei';\n\n/**\n * decode (AUD)Access unit delimiter\n * @param payload\n * @private\n */\nfunction _decodeAUD(payload: Uint8Array): number {\n\t// var primary_pic_type_table = {\n\t//     0x084, // 2, 7\n\t//     0x0a5, // 0, 2, 5, 7\n\t//     0x0e7, // 0, 1, 2, 5, 6, 7\n\t//     0x210, // 4, 9\n\t//     0x318, // 3, 4, 8, 9\n\t//     0x294, // 2, 4, 7, 9\n\t//     0x3bd, // 0, 2, 3, 4, 5, 7, 8, 9\n\t//     0x3ff, // 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\n\t// }\n\n\treturn payload[0] >> 5;\n}\n\nexport default class NALU extends DataViewReader {\n\tforbidden_zero_bit: number;\n\tref_idc: number;\n\tunit_type: number;\n\tdata: Uint8Array;\n\trawData: Uint8Array;\n\tsps: SPSProps;\n\tpps: PPSProps;\n\tsei: SEIProps;\n\tprimary_pic_type: number;\n\tpts?: number;\n\tdts?: number;\n\n\tconstructor(buffer: Uint8Array) {\n\t\tsuper();\n\n\t\tthis.forbidden_zero_bit = buffer[0] >> 7;\n\n\t\t// nalu priority.\n\t\tthis.ref_idc = (buffer[0] >> 5) & 0x03;\n\n\t\t// specifies the type of RBSP data structure. see in mux-nalu-types.js\n\t\tthis.unit_type = buffer[0] & 0x1f;\n\n\t\tthis.data = discardEP3B(buffer.subarray(1));\n\t\tthis.rawData = buffer;\n\n\t\tswitch (this.unit_type) {\n\t\t\tcase NaluTypes.NON_IDR_SLICE:\n\t\t\t\tbreak;\n\t\t\tcase NaluTypes.DPA_SLICE:\n\t\t\tcase NaluTypes.DPB_SLICE:\n\t\t\tcase NaluTypes.DPC_SLICE:\n\t\t\t\t// TODO decode A/B/C Partition Slice.\n\t\t\t\tbreak;\n\t\t\tcase NaluTypes.IDR_SLICE:\n\t\t\t\t// this.data = decodeSlice(this.data).data;\n\t\t\t\tbreak;\n\t\t\tcase NaluTypes.SPS:\n\t\t\t\tthis.sps = decodeSPS(this.data);\n\t\t\t\tbreak;\n\t\t\tcase NaluTypes.PPS:\n\t\t\t\tthis.pps = decodePPS(this.data);\n\t\t\t\tbreak;\n\t\t\tcase NaluTypes.SEI:\n\t\t\t\tthis.sei = decodeSEI(this.data);\n\t\t\t\tbreak;\n\t\t\tcase NaluTypes.AUD:\n\t\t\t\tthis.primary_pic_type = _decodeAUD(this.data);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n","/**\n * @file: avc.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * h.264/AVC codec\n */\nimport EventEmitter from '../util/event-emitter';\nimport NALUnit from './avc/nalu';\n\ninterface CachedBytes extends Uint8Array {\n\tpts?: number;\n\tdts?: number;\n\tstartCodeLength?: number;\n}\n\nexport type AVCCodecData = {\n\tpts: number;\n\tdts: number;\n\tnaluSizeLength?: number;\n\tpayload: Uint8Array;\n};\n\nexport interface AVCDecoderConfigurationRecord {\n\tversion: number;\n\tprofile: number;\n\tprofileCompatibility: number;\n\tlevel: number;\n\tnaluSizeLength: number;\n\tspsNalus: Uint8Array[];\n\tppsNalus: Uint8Array[];\n}\n\nexport class AVCCodec extends EventEmitter {\n\tprivate cachedBytes?: CachedBytes;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.cachedBytes = null;\n\t}\n\n\tpush(data: AVCCodecData) {\n\t\tlet self = this;\n\t\tlet i = 0,\n\t\t\tnaluOffset = 0,\n\t\t\tlastStartCodeLength = 0;\n\t\tlet { pts, dts, payload, naluSizeLength } = data;\n\t\tlet data_byte;\n\n\t\tif (this.cachedBytes) {\n\t\t\ttry {\n\t\t\t\tdata_byte = new Uint8Array(this.cachedBytes.byteLength + payload.byteLength);\n\t\t\t} catch (e) {\n\t\t\t\tthrow `h264 alloc mem error ${this.cachedBytes.byteLength}/${payload.byteLength}`;\n\t\t\t}\n\t\t\tdata_byte.set(this.cachedBytes);\n\t\t\tdata_byte.set(payload, this.cachedBytes.byteLength);\n\t\t} else {\n\t\t\tdata_byte = payload;\n\t\t}\n\n\t\tif (!naluSizeLength) {\n\t\t\tlet j = data_byte.byteLength - 1;\n\t\t\tlet dropZerosLength = 0;\n\n\t\t\t// Collect tailing zeros.\n\t\t\t// end with 0x000000 and more...\n\t\t\tdo {\n\t\t\t\tif (data_byte[j] === 0x00) {\n\t\t\t\t\tdropZerosLength++;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tj--;\n\t\t\t} while (j > 0);\n\n\t\t\tif (dropZerosLength >= 3) {\n\t\t\t\t// drop tailing zeros.\n\t\t\t\tdata_byte = data_byte.subarray(0, j + 1);\n\t\t\t}\n\n\t\t\tdo {\n\t\t\t\tlet uint32 =\n\t\t\t\t\t(data_byte[i] << 24) | (data_byte[i + 1] << 16) | (data_byte[i + 2] << 8) | data_byte[i + 3];\n\t\t\t\tlet start_code = data_byte.length - i >= 4 ? uint32 : -1;\n\t\t\t\tlet start_code_length = 0;\n\t\t\t\tlet isLastByte = i === data_byte.length - 1;\n\n\t\t\t\tif (start_code >> 8 === 1) {\n\t\t\t\t\t/*commence with 3 bytes*/\n\t\t\t\t\tstart_code_length = 3;\n\t\t\t\t} else if (start_code === 1) {\n\t\t\t\t\t/*commence with 4 bytes*/\n\t\t\t\t\tstart_code_length = 4;\n\t\t\t\t}\n\n\t\t\t\tif (start_code_length === 3 || start_code_length === 4 || isLastByte) {\n\t\t\t\t\tlet startPos = naluOffset + lastStartCodeLength;\n\t\t\t\t\tlet isNaluEndByte = isLastByte && dropZerosLength >= 3;\n\n\t\t\t\t\tif (i > naluOffset && (!isLastByte || isNaluEndByte)) {\n\t\t\t\t\t\tlet bytes = data_byte.subarray(startPos, isNaluEndByte ? i + 1 : i);\n\t\t\t\t\t\tlet nalu = new NALUnit(bytes);\n\n\t\t\t\t\t\t// PES\n\t\t\t\t\t\tnalu.pts = pts;\n\t\t\t\t\t\tnalu.dts = dts;\n\n\t\t\t\t\t\tself.emit('nalu', nalu);\n\t\t\t\t\t\tnaluOffset = i;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isLastByte) {\n\t\t\t\t\t\tif (dropZerosLength < 3) {\n\t\t\t\t\t\t\tthis.cachedBytes = data_byte.subarray(naluOffset);\n\t\t\t\t\t\t\tthis.cachedBytes.pts = pts;\n\t\t\t\t\t\t\tthis.cachedBytes.dts = dts;\n\t\t\t\t\t\t\tthis.cachedBytes.startCodeLength = lastStartCodeLength;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cachedBytes = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i === naluOffset) {\n\t\t\t\t\t\t// record last start code length.\n\t\t\t\t\t\tlastStartCodeLength = start_code_length;\n\t\t\t\t\t}\n\n\t\t\t\t\ti += start_code_length || 1;\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t} while (i < data_byte.length);\n\t\t} else {\n\t\t\tlet startPos = 0,\n\t\t\t\tsize = 0,\n\t\t\t\tendPos = 0;\n\t\t\tdo {\n\t\t\t\tsize = 0;\n\t\t\t\tfor (let k = 0; k < naluSizeLength; k++) {\n\t\t\t\t\tsize = size | (data_byte[startPos + k] << ((naluSizeLength - k - 1) * 8));\n\t\t\t\t}\n\t\t\t\t// size = (data_byte[i] << 24) | (data_byte[i + 1] << 16) | (data_byte[i + 2] << 8) | data_byte[i + 3];\n\t\t\t\tstartPos += naluSizeLength;\n\t\t\t\tendPos = startPos + size;\n\t\t\t\tif (endPos > data_byte.length) {\n\t\t\t\t\tendPos = data_byte.length;\n\t\t\t\t}\n\n\t\t\t\tlet bytes = data_byte.subarray(startPos, endPos);\n\t\t\t\tlet nalu = new NALUnit(bytes);\n\t\t\t\t// PES\n\t\t\t\tnalu.pts = pts;\n\t\t\t\tnalu.dts = dts;\n\n\t\t\t\tself.emit('nalu', nalu);\n\t\t\t\tstartPos = endPos;\n\t\t\t} while (startPos < data_byte.length);\n\t\t}\n\n\t\tif (this.cachedBytes) {\n\t\t\tlet nalu = new NALUnit(this.cachedBytes.subarray(this.cachedBytes.startCodeLength));\n\n\t\t\tnalu.pts = this.cachedBytes.pts;\n\t\t\tnalu.dts = this.cachedBytes.dts;\n\n\t\t\tthis.emit('nalu', nalu);\n\n\t\t\tthis.cachedBytes = null;\n\t\t}\n\n\t\tthis.emit('done');\n\t}\n\n\treset() {\n\t\tthis.cachedBytes = null;\n\t}\n}\n","/**\n * @file: avc-config.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport { SPSProps } from './sps';\nimport { PPSProps } from './pps';\n\n/**\n * AVC Config Helper\n * Accord sps/pps, generate mimeType info.\n */\nexport default (sps: SPSProps, pps?: PPSProps) => {\n\tlet profile_idc = sps.profile_idc;\n\tlet profile_compatibility = sps.profile_compatibility;\n\tlet level_idc = sps.level_idc;\n\tlet codecString = 'avc1.';\n\n\tlet arr = [profile_idc, profile_compatibility, level_idc];\n\tfor (let j = 0; j < arr.length; j++) {\n\t\tlet h = arr[j].toString(16);\n\t\tif (h.length < 2) {\n\t\t\th = '0' + h;\n\t\t}\n\t\tcodecString += h;\n\t}\n\n\treturn {\n\t\tcodec: codecString\n\t};\n};\n","/**\n * @file: avc.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * H.264/AVC/HEVC Stream.\n */\nimport { AVCCodec, AVCCodecData } from '../../codec/avc';\nimport getAVCConfig from '../../codec/avc/avc-config';\nimport NALU from '../../codec/avc/nalu';\nimport NaluTypes from '../../enum/nalu-types';\nimport StreamType from '../../enum/stream-types';\nimport logger from '../../util/logger';\nimport Stream from '../../util/stream';\nimport PSI from '../psi';\nimport { AVCFrame, GOP, GOPVector, PESStreamEmitData } from '../types/pipeline';\n\nclass H264Stream extends Stream {\n\tprivate PSI: PSI;\n\tprivate trackId?: number;\n\tprivate currentFrame: AVCFrame;\n\tprivate prevFrame: AVCFrame;\n\tprivate codec: AVCCodec;\n\tprivate gop: GOP;\n\tprivate gops: GOPVector;\n\n\tconstructor(psi: PSI) {\n\t\tsuper();\n\n\t\tthis.PSI = psi;\n\t\tthis.trackId = null;\n\n\t\t/** @private {Array} */\n\t\tthis.currentFrame = []; // a group of nalu\n\n\t\t/** @private {AVCCodec} */\n\t\tthis.codec = new AVCCodec();\n\n\t\tthis._newGop();\n\t\tthis._newGops();\n\n\t\tthis.codec.on('nalu', (nalu: NALU) => {\n\t\t\tif (nalu.unit_type === NaluTypes.SPS) {\n\t\t\t\tlet track = this.PSI.findTrack(this.trackId);\n\t\t\t\tlet config = getAVCConfig(nalu.sps);\n\n\t\t\t\t// write sps info to video track.\n\t\t\t\ttrack.codec = config.codec;\n\t\t\t\ttrack.width = nalu.sps.width;\n\t\t\t\ttrack.height = nalu.sps.height;\n\t\t\t\ttrack.profileIdc = nalu.sps.profile_idc;\n\t\t\t\ttrack.profileCompatibility = nalu.sps.profile_compatibility;\n\t\t\t\ttrack.levelIdc = nalu.sps.level_idc;\n\t\t\t\ttrack.pixelRatio = nalu.sps.pixelRatio;\n\t\t\t\ttrack.sps = [nalu.rawData];\n\t\t\t} else if (nalu.unit_type === NaluTypes.PPS) {\n\t\t\t\tlet track = this.PSI.findTrack(this.trackId);\n\t\t\t\ttrack.pps = [nalu.rawData];\n\t\t\t}\n\n\t\t\tthis._grouping(nalu);\n\t\t});\n\t}\n\n\t/**\n\t * Push a complete pes\n\t * @param data\n\t */\n\tpush(data: PESStreamEmitData) {\n\t\tconst { stream_type, pes, pid } = data;\n\t\tif (stream_type === StreamType.H264 || stream_type === StreamType.HEVC) {\n\t\t\tthis.trackId = pid;\n\n\t\t\tlet rawData: AVCCodecData = {\n\t\t\t\tpts: pes.PTS,\n\t\t\t\tdts: pes.DTS,\n\t\t\t\tpayload: pes.data_byte\n\t\t\t};\n\n\t\t\tthis.codec.push(rawData);\n\t\t}\n\t}\n\n\tflush() {\n\t\t// Push last frame into gop.\n\t\tif (this.currentFrame.length > 0) {\n\t\t\t// If the last frame has valid duration, use the duration of the previous frame\n\t\t\tif (!this.currentFrame.duration || this.currentFrame.duration <= 0) {\n\t\t\t\tthis.currentFrame.duration = this.prevFrame.duration || 0;\n\t\t\t}\n\n\t\t\tthis._pushFrameIntoGop();\n\t\t\tthis.currentFrame = [];\n\t\t}\n\n\t\t// Push last gop.\n\t\tif (this.gop.length > 0) {\n\t\t\tthis._pushGopIntoGroup();\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.codec.reset();\n\n\t\tthis.currentFrame = [];\n\t\tthis._newGop();\n\t\tthis._newGops();\n\t}\n\n\t/**\n\t * Group nalu into frame & gop.\n\t * @param currentNal\n\t * @private\n\t */\n\t_grouping(currentNal) {\n\t\tif (currentNal.unit_type === NaluTypes.AUD) {\n\t\t\tif (this.currentFrame.length > 0) {\n\t\t\t\tthis.currentFrame.duration = currentNal.dts - this.currentFrame.dts;\n\n\t\t\t\tif (this.gop.length > 0 && this.currentFrame.keyframe) {\n\t\t\t\t\tthis.gop.trackId = this.trackId;\n\n\t\t\t\t\tthis._pushGopIntoGroup();\n\t\t\t\t}\n\n\t\t\t\t// the gop should commence with a key frame,\n\t\t\t\t// or the frame will be dropped until finding one that contains a key frame.\n\t\t\t\tif (this.currentFrame.keyframe || this.gop.length > 0) {\n\t\t\t\t\tthis._pushFrameIntoGop();\n\t\t\t\t} else {\n\t\t\t\t\tlogger.warn(`h264 codec drop frame`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.prevFrame = this.currentFrame;\n\n\t\t\t// end a frame.\n\t\t\tthis.currentFrame = [];\n\t\t\tthis.currentFrame.keyframe = false;\n\t\t\tthis.currentFrame.byteLength = 0;\n\t\t\tthis.currentFrame.naluCount = 0;\n\t\t\tthis.currentFrame.pts = currentNal.pts;\n\t\t\tthis.currentFrame.dts = currentNal.dts;\n\t\t} else {\n\t\t\tif (currentNal.unit_type === NaluTypes.IDR_SLICE) {\n\t\t\t\tthis.currentFrame.keyframe = true;\n\t\t\t}\n\n\t\t\tthis.currentFrame.byteLength += currentNal.rawData.byteLength;\n\t\t\tthis.currentFrame.naluCount++;\n\t\t\tthis.currentFrame.push(currentNal);\n\t\t}\n\n\t\tthis.currentFrame.duration = currentNal.dts - this.currentFrame.dts;\n\t}\n\n\t_newGop() {\n\t\tthis.gop = []; // a group of idr-start-frame sequence\n\n\t\tthis.gop.duration = 0;\n\t\tthis.gop.naluCount = 0;\n\t\tthis.gop.byteLength = 0;\n\t}\n\n\t_pushFrameIntoGop() {\n\t\t// Gop\n\t\tthis.gop.push(this.currentFrame);\n\t\tthis.gop.duration += this.currentFrame.duration;\n\t\tthis.gop.byteLength += this.currentFrame.byteLength;\n\t\tthis.gop.naluCount += this.currentFrame.naluCount;\n\t}\n\n\t_newGops() {\n\t\tthis.gops = []; // a group of gop\n\t\tthis.gops.type = 'video';\n\t\tthis.gops.duration = 0;\n\t\tthis.gops.naluCount = 0;\n\t\tthis.gops.byteLength = 0;\n\t\tthis.gops.frameLength = 0;\n\t\tthis.gops.firstDTS = 0;\n\t}\n\n\t_pushGopIntoGroup() {\n\t\tlet firstFrame = this.gop[0];\n\t\t// GOPs\n\t\tthis.gops.trackId = this.trackId;\n\t\tthis.gops.duration += this.gop.duration;\n\t\tthis.gops.byteLength += this.gop.byteLength;\n\t\tthis.gops.naluCount += this.gop.naluCount;\n\t\tthis.gops.frameLength += this.gop.length;\n\t\tthis.gops.firstDTS = firstFrame.dts;\n\t\tthis.gops.firstPTS = firstFrame.pts;\n\n\t\tthis.gops.push(this.gop);\n\n\t\tthis.emit('data', this.gops);\n\n\t\tthis._newGop();\n\t\tthis._newGops();\n\n\t\tthis.emit('done');\n\t}\n}\n\nexport default H264Stream;\n","/**\n * @file: elementary.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Elementary Stream.\n * @summary An elementary stream (ES) as defined by the MPEG communication protocol is usually the output of an audio or video encoder.\n *      ES contains only one kind of data, e.g. audio, video or closed caption.\n * @description  https://en.wikipedia.org/wiki/Elementary_stream\n */\nimport StreamType from '../../enum/stream-types';\nimport { Context, GlobalOptions } from '../../types/globals';\nimport { isNumber } from '../../util/is';\nimport logger from '../../util/logger';\nimport Stream from '../../util/stream';\nimport PSI from '../psi';\nimport { PESStreamEmitData, GOPVector } from '../types/pipeline';\nimport ADTSStream from './adts';\nimport AVCStream from './avc';\n\nclass ElementaryStream extends Stream {\n\tprivate context: Context;\n\tprivate PSI: PSI;\n\tprivate options: GlobalOptions;\n\tprivate tracks: Array<GOPVector>;\n\tprivate adtsStream: ADTSStream;\n\tprivate avcStream: AVCStream;\n\tprivate streams: [ADTSStream, AVCStream];\n\n\tconstructor(ctx: Context, psi: PSI, options: GlobalOptions = {}) {\n\t\tsuper();\n\n\t\tthis.context = ctx;\n\t\tthis.PSI = psi;\n\t\tthis.options = options;\n\t\tthis.tracks = [];\n\t\tthis.adtsStream = new ADTSStream(psi);\n\t\tthis.avcStream = new AVCStream(psi);\n\t\tthis.streams = [this.adtsStream, this.avcStream];\n\n\t\tif (options.decodeCodec) {\n\t\t\tthis.avcStream.on('data', (data: GOPVector) => {\n\t\t\t\tlet stubTime = options.config.stubTime;\n\n\t\t\t\tif (isNumber(stubTime)) {\n\t\t\t\t\tlet end = (data.firstPTS + data.duration) / 90000;\n\t\t\t\t\tif (end < stubTime) {\n\t\t\t\t\t\tlogger.warn(`drop avc gop, start/end/stubTime(${data.firstPTS}/${end}/${stubTime})`);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.tracks.push(data);\n\t\t\t\tthis.emit('data', this.tracks);\n\t\t\t\tthis.tracks = [];\n\t\t\t\tthis.adtsStream.flush();\n\t\t\t});\n\n\t\t\tthis.adtsStream.on('data', (data) => {\n\t\t\t\tlet stubTime = options.config.stubTime;\n\n\t\t\t\tif (isNumber(stubTime)) {\n\t\t\t\t\tlet end = (data.firstPTS + data.duration) / 90000;\n\t\t\t\t\tif (end < stubTime) {\n\t\t\t\t\t\tlogger.warn(`drop adts, start/end/stubTime(${data.firstPTS}/${end}/${stubTime})`);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.tracks.push(data);\n\t\t\t\tthis.emit('data', this.tracks);\n\t\t\t\tthis.tracks = [];\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Push a complete pes\n\t * @param data\n\t */\n\tpush(data: PESStreamEmitData): void {\n\t\tconst { options, adtsStream, avcStream } = this;\n\t\tlet { stream_type } = data;\n\n\t\tif (options.decodeCodec) {\n\t\t\tswitch (stream_type) {\n\t\t\t\tcase StreamType.H264:\n\t\t\t\tcase StreamType.HEVC:\n\t\t\t\t\tavcStream.push(data);\n\t\t\t\t\tbreak;\n\t\t\t\tcase StreamType.ADTS:\n\t\t\t\t\tadtsStream.push(data);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tlogger.warn(`ts elementary encounter unknown stream type ${stream_type}`);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.emit('data', data);\n\t\t}\n\t}\n\n\tflush(): void {\n\t\tlet { streams, tracks } = this;\n\t\tfor (let i = 0; i < this.streams.length; i++) {\n\t\t\tlet stream = streams[i];\n\n\t\t\tstream.flush();\n\t\t}\n\n\t\tif (tracks.length > 0) {\n\t\t\tthis.emit('data', tracks);\n\t\t}\n\n\t\tthis.emit('done');\n\n\t\ttracks.splice(0, tracks.length);\n\t}\n\n\treset(): void {\n\t\tthis.tracks = [];\n\n\t\tfor (let i = 0; i < this.streams.length; i++) {\n\t\t\tlet stream = this.streams[i];\n\n\t\t\tstream.reset();\n\t\t}\n\n\t\tthis.emit('reset');\n\t}\n}\n\nexport default ElementaryStream;\n","/**\n * @file: pes.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport DataViewReader from '../../util/dv';\n\n/**\n * @extends DataViewReader\n */\nclass Pes extends DataViewReader {\n\tstart_code_prefix: number;\n\tstream_id: number;\n\tpacket_length: number;\n\tdata_alignment_indicator: number;\n\tcopyright: number;\n\tPTS_DTS_flags: number;\n\tESCR_flag: number;\n\tES_rate_flag: number;\n\ttrick_mode_flag: number;\n\tadditional_copy_info_flag: number;\n\tCRC_flag: number;\n\textension_flag: number;\n\theader_data_length: number;\n\tPTS: number;\n\tDTS: number;\n\tdata_byte: Uint8Array;\n\n\tconstructor(buffer: Uint8Array) {\n\t\tsuper();\n\n\t\t// The packet_start_code_prefix is a 24-bit code.\n\t\tthis.start_code_prefix = (this.readUint16(buffer, 0) << 8) | buffer[2];\n\n\t\t// In Transport Streams,\n\t\t// the stream_id may be set to any valid value which correctly describes the elementary stream type.\n\t\t// the elementary stream type is specified in the PSI(Program Specific Information).\n\t\tthis.stream_id = buffer[3];\n\n\t\t// A 16-bit field specifying the number of bytes in the PES packet.\n\t\tthis.packet_length = this.readUint16(buffer, 4);\n\n\t\tthis.data_alignment_indicator = buffer[6] & 0x04;\n\n\t\tthis.copyright = buffer[6] & 0x02;\n\n\t\t// PTS (presentation time stamp)\n\t\t// DTS (decoding time stamp)\n\t\tthis.PTS_DTS_flags = buffer[7] >> 6;\n\n\t\t// ESCR (Elementary Stream Clock Reference system):\n\t\t// A time stamp in the PES Stream from which decoders of PES streams may derive timing.\n\t\tthis.ESCR_flag = buffer[7] & 0x20;\n\n\t\tthis.ES_rate_flag = buffer[7] & 0x10;\n\n\t\tthis.trick_mode_flag = buffer[7] & 0x08;\n\n\t\tthis.additional_copy_info_flag = buffer[7] & 0x04;\n\n\t\tthis.CRC_flag = buffer[7] & 0x02;\n\n\t\tthis.extension_flag = buffer[7] & 0x01;\n\n\t\tthis.header_data_length = buffer[8];\n\n\t\tthis.PTS = 0;\n\t\tif ((this.PTS_DTS_flags & 0x02) == 0x02) {\n\t\t\tthis.PTS = this.calcTimestamp_(buffer, 9);\n\t\t}\n\n\t\t// if there is no dts, let DTS=PTS\n\t\t// See Annex D - D.0.2 Audio and Video Presentation Synchronization\n\t\tthis.DTS = this.PTS;\n\n\t\tif ((this.PTS_DTS_flags & 0x01) == 0x01) {\n\t\t\tthis.DTS = this.calcTimestamp_(buffer, 14);\n\t\t}\n\n\t\t// if (this.ESCR_flag === 1) {\n\t\t// }\n\t\t//\n\t\t// if (this.ES_rate_flag === 1) {\n\t\t// }\n\t\t//\n\t\t//\n\t\t// if (this.trick_mode_flag === 1) {\n\t\t//\n\t\t// }\n\t\t//\n\t\t// if (this.ESCR_flag === 1) {\n\t\t// }\n\n\t\tthis.data_byte = buffer.subarray(9 + this.header_data_length);\n\n\t\t// this.isStartPes = (buffer[0] << 16 | buffer[1] << 8 | buffer[2]) & 0xffffff === 0x000001;\n\t}\n\n\t/**\n\t * @param buffer\n\t * @param start\n\t */\n\tprivate calcTimestamp_(buffer: Uint8Array, start: number): number {\n\t\t// PTS / DTS is 33 bit\n\t\treturn (\n\t\t\t// JS Bitwise operators treat their operands as a sequence of 32 bits,\n\t\t\t// We cannot use bitwise operator in JS beyond 32bits\n\t\t\t(buffer[start] & 0x0e) * 536870912 + // Math.pow(2, 29) === 536870912\n\t\t\t(buffer[start + 1] << 22) +\n\t\t\t((buffer[start + 2] >> 1) << 15) +\n\t\t\t(buffer[start + 3] << 7) +\n\t\t\t(buffer[start + 4] >> 1)\n\t\t);\n\t}\n\n\tvalid(): boolean {\n\t\tlet start_code_prefix = this.start_code_prefix;\n\n\t\treturn start_code_prefix[0] === 0x00 && start_code_prefix[1] === 0x00 && start_code_prefix[2] === 0x01;\n\t}\n}\n\nexport default Pes;\n","/**\n * @file: pes.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Packetized Elementary Stream.\n */\nimport { Context } from '../../types/globals';\nimport CacheBuffer from '../../util/cache-buffer';\nimport Stream from '../../util/stream';\nimport PSI from '../psi';\nimport Packet from '../structs/packet';\nimport PES from '../structs/pes';\nimport { PESStreamEmitData } from '../types/pipeline';\n\nclass PesStream extends Stream {\n\tprivate context: Context;\n\tprivate PSI: PSI;\n\tprivate PID?: number;\n\tprivate cache_buffer: CacheBuffer;\n\n\tconstructor(ctx: Context, psi: PSI) {\n\t\tsuper();\n\n\t\tthis.context = ctx;\n\t\tthis.PSI = psi;\n\t\tthis.PID = null;\n\t\tthis.cache_buffer = new CacheBuffer();\n\t}\n\n\t/**\n\t * @param packet\n\t */\n\tpush(packet: Packet) {\n\t\tconst self = this;\n\n\t\t// PES PID\n\t\tif (packet.PID > 0x00ff && packet.PID < 0x1fff) {\n\t\t\tif (this.PSI.currentProgramPID == -1) {\n\t\t\t\tself._pushPacket(packet);\n\t\t\t} else if (this.PSI.currentProgramPID !== packet.PID) {\n\t\t\t\tif (packet.payload_unit_start_indicator === 1) {\n\t\t\t\t\tself._assembleOnePES();\n\t\t\t\t}\n\n\t\t\t\tself._pushPacket(packet);\n\t\t\t}\n\t\t}\n\t}\n\n\tflush() {\n\t\tconst self = this;\n\n\t\t// 组装最后一个PES\n\t\tself._assembleOnePES();\n\n\t\tself.emit('done');\n\t}\n\n\treset() {\n\t\tthis._clearCached();\n\n\t\tthis.emit('reset');\n\t}\n\n\t_clearCached() {\n\t\tthis.PID = null;\n\t\tthis.cache_buffer.clear();\n\t}\n\n\t_pushPacket(p) {\n\t\tlet empty = this.cache_buffer.empty;\n\n\t\t// Make first packet in cache is start unit.\n\t\tif (empty && p.payload_unit_start_indicator === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (empty) {\n\t\t\tthis.PID = p.PID;\n\t\t}\n\n\t\tthis.cache_buffer.append(p.payload);\n\t}\n\n\t_assembleOnePES() {\n\t\tconst self = this;\n\n\t\tif (!this.cache_buffer.empty) {\n\t\t\tlet bytes;\n\n\t\t\ttry {\n\t\t\t\tbytes = this.cache_buffer.toNewBytes();\n\t\t\t} catch (e) {\n\t\t\t\tthrow `pes alloc mem err ${this.cache_buffer.byteLength}`;\n\t\t\t}\n\n\t\t\tlet pesData = new PES(bytes);\n\t\t\tlet track = this.PSI.findTrack(this.PID);\n\n\t\t\t// console.log(`stream_id: ${pesData.stream_id}, PTS: ${pesData.PTS}, DTS: ${pesData.DTS}`);\n\n\t\t\tif (track) {\n\t\t\t\tlet data: PESStreamEmitData = {\n\t\t\t\t\tpid: track.id,\n\t\t\t\t\tstream_type: track.stream_type,\n\t\t\t\t\tpcr_pid: track.pcr_pid,\n\t\t\t\t\tpes: pesData\n\t\t\t\t};\n\t\t\t\t// Assemble one pes packet, emit it to next stream.\n\t\t\t\tself.emit('data', data);\n\t\t\t}\n\n\t\t\tself._clearCached();\n\t\t}\n\t}\n}\n\nexport default PesStream;\n","/**\n * @file: packet.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * packet structure.\n */\nimport DataViewReader from '../../util/dv';\n\nconst SYNC_BYTE = 0x47; // The sync_byte is a fixed 8-bit field whose value is '0100 0111' (0x47).\n\n/**\n * @extends DataViewReader\n */\nclass Packet extends DataViewReader {\n\tsync_byte: number;\n\ttransport_error_indicator: number;\n\tpayload_unit_start_indicator: number;\n\ttransport_priority: number;\n\tPID: number;\n\ttsc: number;\n\tafc: number;\n\tcontinuity_counter: number;\n\thas_payload: number;\n\thas_adaptation: number;\n\t// is_discontinuity: boolean;\n\tpayload: Uint8Array;\n\n\t/**\n\t * @param buffer\n\t */\n\tconstructor(buffer: Uint8Array) {\n\t\tsuper();\n\n\t\tthis.sync_byte = buffer[0];\n\n\t\tthis.transport_error_indicator = buffer[1] >> 7;\n\n\t\t// Indicating transport stream packets carry PES packets or PSI data\n\t\t// PES: 1 -> commence with the first byte of a PES packet,  0 -> no PES packet shall start in this packet.\n\t\t// PSI: 1 -> carries the first byte of a PSI section, 0 -> no pointer_field in the payload.\n\t\tthis.payload_unit_start_indicator = (buffer[1] >> 6) & 1;\n\n\t\tthis.transport_priority = (buffer[1] >>> 5) & 1;\n\n\t\t// The PID(Packet ID) is a 13-bit field, indicating the type of the data stored in the packet payload.\n\t\t// NOTE – The transport packets with PID values 0x0000, 0x0001, and 0x0010-0x1FFE are allowed to carry a PCR.\n\t\t// ISO/IEC 13818-1 : 2000 (E)\n\t\t// Value                  Description\n\t\t// 0x0000                 Program Association Table\n\t\t// 0x0001                 Conditional Access Table\n\t\t// 0x0002                 Transport Stream Description Table\n\t\t// 0x0003-0x000F          Reserved\n\t\t// 0x0010 ... 0x1FFE      May be assigned as network_PID, Program_map_PID, elementary_PID, or for other purposes\n\t\t// https://www.dvb.org/resources/public/standards/a38_dvb-si_specification.pdf\n\t\t// 0x0040                 Network_information_section-actual_network\n\t\t// 0x0041                 Network_information_section-other_network\n\t\t// 0x0042                 Service_description_section-actual_transport_stream\n\t\t// 0x0043                 TO 0x45 Reserved for future use\n\t\t// 0x0046                 Service_description_section-other_transport_stream\n\t\t// 0x0047                 TO 0x49 Reserved for future use\n\t\t// 0x004A                 Bouquet_association_section\n\t\t// 0x004B                 TO 0x4D Reserved for future use\n\t\t// 0x004E                 Event_information_section-actual_transport_stream,P/F\n\t\t// 0x004F                 Event_information_section-other_transport_stream,P/F\n\t\t// 0x0050                 TO 0x5F Event_information_section-actual_transport_stream,schedule\n\t\t// 0x0060                 TO 0x6F Event_information_section-other_transport_stream,schedule\n\t\t// 0x0070                 Time_data_section\n\t\t// 0x0071                 Running_status_section\n\t\t// 0x0072                 Stuffing_section\n\t\t// 0x0073                 Time_offset_section\n\t\t// 0x0074                 TO 0x007D Reserved for future use\n\t\t// 0x007E                 Discontinuity_information_section\n\t\t// 0x007F                 Selection_information_section\n\t\t// 0x0080                 TO 0x00FE User defined\n\t\t// 0x00FF                 Reserved\n\t\t// 0x1FFF                 Null packet\n\t\tthis.PID = this.readUint16(buffer, 1) & 0x1fff;\n\n\t\t// transport_scrambling_control\n\t\tthis.tsc = buffer[3] >> 6;\n\n\t\t// adaptation_field_control\n\t\t// Value  Description\n\t\t// 00     Reserved for future use by ISO/IEC\n\t\t// 01     No adaptation_field, payload only\n\t\t// 10     Adaptation_field only, no payload\n\t\t// 11     Adaptation_field followed by payload\n\t\tthis.afc = (buffer[3] >> 4) & 3;\n\n\t\t// '1' indicates that the discontinuity state is true for the current Transport Stream packet.\n\t\t// continuity_counter\n\t\tthis.continuity_counter = buffer[3] & 0xf;\n\n\t\t// self defines.\n\t\tthis.has_payload = this.afc & 1;\n\t\tthis.has_adaptation = this.afc & 2;\n\t\t// this.is_discontinuity = this.has_adaptation && buffer[4] != 0 /* with length > 0 */ && buffer[5] & 0x80;\n\t\t/* and discontinuity indicated */\n\n\t\tif (this.has_payload) {\n\t\t\tif (this.has_adaptation) {\n\t\t\t\tlet adaptation_field_length = buffer[4];\n\t\t\t\tthis.payload = buffer.subarray(5 + adaptation_field_length);\n\t\t\t} else {\n\t\t\t\tthis.payload = buffer.subarray(4);\n\t\t\t}\n\t\t}\n\t}\n\n\tvalid(): boolean {\n\t\tlet val = this.sync_byte === SYNC_BYTE && this.has_payload === 1;\n\t\treturn val;\n\t}\n}\n\nexport default Packet;\n","/**\n * @file: demux.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * MPEG-2 transport stream demuxer.\n */\nimport DemuxFacade from '../demux-facade';\nimport muxErrorCode from '../mux-error-code';\nimport { GlobalOptions, PushConf } from '../types/globals';\nimport logger from '../util/logger';\nimport PSI from './psi';\nimport M2TSComplexStream from './streams/complex';\nimport ElementaryStream from './streams/elementary';\nimport PesStream from './streams/pes';\nimport Packet from './structs/packet';\n\nconst CHUNK_BYTE_LENGTH = 188; // Transport Stream chunks shall be 188 bytes long.\n\ntype InterfaceStream = M2TSComplexStream | ElementaryStream;\n\nexport class TSDemux extends DemuxFacade {\n\tprivate psi_: PSI;\n\tprivate pesStream_: PesStream;\n\tprivate elementaryStream_: ElementaryStream;\n\tprivate complexStream_: M2TSComplexStream;\n\n\tconstructor(options: GlobalOptions = {}) {\n\t\tsuper(options);\n\n\t\tthis.psi_ = new PSI(this.ctx_);\n\t\tthis.pesStream_ = new PesStream(this.ctx_, this.psi_);\n\t\tthis.elementaryStream_ = new ElementaryStream(this.ctx_, this.psi_, options);\n\t\tthis.complexStream_ = new M2TSComplexStream(this.ctx_, this.psi_);\n\n\t\t// Compose pipeline\n\t\tthis.pipe(this.pesStream_);\n\t\tthis.pesStream_.pipe(this.elementaryStream_);\n\t\tthis.elementaryStream_.pipe(this.complexStream_);\n\n\t\tsuper.listenEndStream_();\n\t}\n\n\t/**\n\t * This is end pipeline stream\n\t */\n\tget endStream(): InterfaceStream {\n\t\tlet stream: InterfaceStream = this.elementaryStream_;\n\n\t\tif (this.options_.decodeCodec) {\n\t\t\tstream = this.complexStream_;\n\t\t}\n\n\t\treturn stream;\n\t}\n\n\t/**\n\t * TS push support streaming incomplete data push.\n\t * @param buffer\n\t * @param conf\n\t * @param conf.done - If you need the done event, this boolean needs to be set\n\t */\n\tpush(buffer: ArrayBuffer | Uint8Array, conf: PushConf) {\n\t\tconst { done } = conf;\n\t\tconst { options_, ctx_, cache_buffer_, psi_ } = this;\n\t\tlet newBuf: Uint8Array = super.constraintPushData_(buffer);\n\t\tlet cacheByteLength = cache_buffer_.byteLength;\n\t\tlet byteOffset = null;\n\n\t\toptions_.config = conf;\n\n\t\tlogger.log(\n\t\t\t`hls demux received ${newBuf.byteLength} bytes, cache ${cacheByteLength} bytes. ${done ? 'chunk done' : ''}`\n\t\t);\n\n\t\tcache_buffer_.append(newBuf);\n\n\t\twhile (cache_buffer_.byteLength >= CHUNK_BYTE_LENGTH) {\n\t\t\tlet chunk = cache_buffer_.cut(CHUNK_BYTE_LENGTH);\n\n\t\t\t// The pushed buffer may be so small that can't cut a ts chunk.\n\t\t\tif (chunk) {\n\t\t\t\tlet packet = new Packet(chunk);\n\n\t\t\t\tif (packet.valid()) {\n\t\t\t\t\tpsi_.parse(packet);\n\n\t\t\t\t\tthis.emit('data', packet);\n\t\t\t\t} else {\n\t\t\t\t\tlet errMsg = `Encounter invalid ts packet, packet_length(${chunk.length}), cache_length(${this.cache_buffer_.byteLength}), has_payload(${packet.has_payload}), data(${chunk})`;\n\n\t\t\t\t\tlogger.error(errMsg);\n\n\t\t\t\t\tthis.reset();\n\n\t\t\t\t\tctx_.emit('error', muxErrorCode.TS_SYNC_BYTE, errMsg, {\n\t\t\t\t\t\tstartByte: byteOffset,\n\t\t\t\t\t\tendByte: byteOffset + chunk.byteLength\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbyteOffset += chunk.byteLength;\n\t\t\t}\n\t\t}\n\n\t\tif (cache_buffer_.empty && done) {\n\t\t\t// logger.log('mux packet done!');\n\t\t\tthis.emit('done');\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.cache_buffer_.clear();\n\n\t\tthis.emit('reset');\n\t}\n}\n"],"names":["Events","console","global","NALUnit","AVCStream","PES"],"mappings":"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"}